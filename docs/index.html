<html>
	<head>
		<title>Tiramisu</title>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
		<style>body {
    margin: 0;
    padding: 0;
    font: 14px/1.5 'Palatino Linotype', 'Book Antiqua', Palatino, FreeSerif, serif;
    color: #252519;
}
a {
    color: #252519;
}
a:hover {
    text-decoration: underline;
    color: #19469D;
}
p {
    margin: 12px 0;
}
h1, h2, h3 {
    margin: 0;
    padding: 0;
}
table#source {
    width: 100%;
    border-collapse: collapse;
}
table#source td:first-child {
    padding: 30px 40px 30px 40px;
    vertical-align: top;
}
table#source td:first-child,
table#source td:first-child pre {
    width: 450px;
}
table#source td:last-child {
    padding: 30px 0 30px 40px;
    border-left: 1px solid #E5E5EE;
    background: #F5F5FF;
}
table#source tr {
    border-bottom: 1px solid #E5E5EE;
}
table#source tr.filename {
    padding-top: 40px;
    border-top: 1px solid #E5E5EE;
}
table#source tr.filename td:first-child {
    text-transform: capitalize;
}
table#source tr.filename td:last-child {
    font-size: 12px;
}
table#source tr.filename h2 {
    margin: 0;
    padding: 0;
    cursor: pointer;
}
table#source tr.code h1,
table#source tr.code h2,
table#source tr.code h3 {
    margin-top: 30px;
    font-family: "Lucida Grande", "Helvetica Nueue", Arial, sans-serif;
    font-size: 18px;
}
table#source tr.code h2 {
    font-size: 16px;
}
table#source tr.code h3 {
    font-size: 14px;
}
table#source tr.code ul {
    margin: 15px 0 15px 35px;
    padding: 0;
}
table#source tr.code ul li {
    margin: 0;
    padding: 1px 0;
}
table#source tr.code ul li p {
    margin: 0;
    padding: 0;
}
table#source tr.code td:first-child pre {
    padding: 20px;
}
#ribbon {
    position: fixed;
    top: 0;
    right: 0;
}
code .string { color: #219161; }
code .regexp { color: #219161; }
code .keyword { color: #954121; }
code .number { color: #19469D; }
code .comment { color: #bbb; }
code .this { color: #19469D; }</style>
		<script>
			$(function(){
				$('tr.code').hide();
				$('tr.filename').toggle(function(){
					$(this).nextUntil('.filename').fadeIn();
				}, function(){
					$(this).nextUntil('.filename').fadeOut();
				});
			});
		</script>
	</head>
	<body>
<table id="source"><tbody><tr><td><h1>Tiramisu</h1><h3>version 0.1.3-b2</h3>

<p>Tiramisu is a tiny, modular and fast JavaScript framework 
which takes inspiration from the famous <a href="http://jquery.com/">jQuery</a> syntax:</p>

<pre><code>tiramisu.get('h1').each(function() {
    alert(h1.html());
});</code></pre>

<p>Here are some highlights:</p>

<ul><li>Modular <em>philosophy</em>;</li><li><em>Very small</em> size (7,1Kb minified);</li><li><em>Chainable</em> methods;</li><li>Task management (a.k.a. Callbacks scheduling);</li></ul>

<h2>Resources</h2>

<ul><li><a href="http://dl.dropbox.com/u/2060843/tiramisu/docs/index.html">Documentation (0.1.3-b2)</a></li><li><a href="http://dl.dropbox.com/u/2060843/tiramisu/test/runtests.html">Unit Tests</a></li></ul></td><td></td></tr><tr class="filename"><td><h2 id="src/tiramisu.js"><a href="#">tiramisu</a></h2></td><td>src/tiramisu.js</td></tr><tr class="code">
<td class="docs">
<p>The Framework's costructor exposes externally:</p>

<ul><li>A version number;</li><li>A document object reference;</li><li><em>requestAnimFrame</em> (used for handling tasks).
 </li></ul>
</td>
<td class="code">
<pre><code><span class="keyword">function</span> <span class="class">Tiramisu</span>() {
        <span class="this">this</span>.<span class="variable">version</span> = <span class="string">'0.1.3-b2'</span>;
        <span class="this">this</span>.<span class="variable">d</span> = <span class="variable">document</span>;
        <span class="this">this</span>.<span class="variable">selector</span> = <span class="string">'QSA'</span>
        <span class="this">this</span>.<span class="variable">requestAnimFrame</span> = (<span class="keyword">function</span>() {
            <span class="keyword">return</span> <span class="variable">window</span>.<span class="variable">requestAnimationFrame</span> || <span class="variable">window</span>.<span class="variable">webkitRequestAnimationFrame</span> || <span class="variable">window</span>.<span class="variable">mozRequestAnimationFrame</span> || <span class="variable">window</span>.<span class="variable">oRequestAnimationFrame</span> || <span class="variable">window</span>.<span class="variable">msRequestAnimationFrame</span> ||
            <span class="keyword">function</span>(<span class="variable">callback</span>, <span class="variable">element</span>) {
                <span class="variable">window</span>.<span class="variable">setTimeout</span>(<span class="variable">callback</span>, <span class="number integer">1000</span> / <span class="number integer">60</span>);
            };
        })();
    }

    <span class="comment">// Exposing the framework</span>
    <span class="variable">window</span>.<span class="variable">tiramisu</span> = <span class="variable">window</span>.<span class="variable">t</span> = <span class="keyword">new</span> <span class="class">Tiramisu</span>();

    <span class="comment">// Extending object1 with object2's methods</span>

    <span class="keyword">function</span> <span class="variable">extend</span>(<span class="variable">first</span>, <span class="variable">second</span>) {
        <span class="keyword">for</span> (<span class="keyword">var</span> <span class="variable">prop</span> <span class="keyword">in</span> <span class="variable">second</span>) {
            <span class="variable">first</span>[<span class="variable">prop</span>] = <span class="variable">second</span>[<span class="variable">prop</span>];
        }
    }</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<h1>Framework Detection Module</h1>

<p>This module is mainly used to perform several <em>browser-detection tests</em>:</p>

<ul><li>browser</li><li>isIE, isFirefox, isChrome</li><li>querySelectorAll</li><li>opacity, color</li></ul>

<p>Compatibility for not support CSS:</p>

<ul><li>position:fixed - iOS Safari / Opera Mini</li><li>CSS3 Opacity - I8 older using the "filter" property</li><li>CSS3 Colors - I8 older using rgb rather than rgba</li></ul>

<h2>Example #1 (Detect browser)</h2>

<p>Here's an example on how to <em>detect</em> the current browser:</p>

<pre><code>if (tiramisu.detect('browser') === 'IE9')) {
    console.log('IE');
}</code></pre>

<p>A shortcut to perform this check is:</p>

<pre><code>if (tiramisu.detect('isIE')) {
    console.log('IE');
}</code></pre>

<p>The main difference between the first and the second example is that
<em>isIE</em> and, in general, <em>is(X)</em> methods doesn't check the browser for
a specific version.</p>

<p>If you need to perform a check for a specific version you'll need to rely on <em>detect('browser')</em>;
the possible return values are:</p>

<ul><li><em>safarichrome</em>;</li><li><em>firefox3</em>;</li><li><em>firefox4</em>;</li><li><em>Opera10.4</em>;</li><li><em>Opera10.5+</em>;</li><li><em>IE_older</em> (For IE &lt;= 6).</li><li><em>IE8</em>;</li><li><em>IE9+</em>;</li></ul>

<h2></h2>

<ul><li><p><strong>param</strong>: <em>String</em>  key The test to perform (see the var tests below)</p></li><li><p><strong>returns</strong>: <em>Boolean</em>  The test result</p></li><li><p><strong>api</strong>: <em>public</em></p><p> </p></li></ul>
</td>
<td class="code">
<pre><code><span class="class">Tiramisu</span>.<span class="variable">prototype</span>.<span class="variable">detect</span> = <span class="keyword">function</span>(<span class="variable">key</span>) {
        <span class="keyword">var</span> <span class="variable">nav_agent</span> = <span class="variable">navigator</span>.<span class="variable">userAgent</span>,
            <span class="variable">nav_name</span> = <span class="variable">navigator</span>.<span class="variable">appName</span>;

        <span class="comment">// Netscape includes Firefox, Safari or Chrome</span>
        <span class="keyword">var</span> <span class="variable">tests</span> = {

            <span class="string">'browser'</span>: <span class="keyword">function</span>() {
                <span class="keyword">if</span> (<span class="variable">nav_name</span> === <span class="string">'Netscape'</span>) {
                    <span class="keyword">var</span> <span class="variable">firefox</span> = <span class="variable">nav_agent</span>.<span class="variable">substring</span>(<span class="variable">nav_agent</span>.<span class="variable">indexOf</span>(<span class="string">'Firefox'</span>));
                    <span class="keyword">if</span> (<span class="variable">firefox</span>.<span class="variable">split</span>(<span class="string">'/'</span>)[<span class="number integer">0</span>] !== <span class="string">'Firefox'</span>) { <span class="comment">// Case 1 - Safari or Chrome</span>
                        <span class="keyword">return</span> &<span class="variable">quot</span>;<span class="variable">webkit</span>&<span class="variable">quot</span>;
                    } <span class="keyword">else</span> {
                        <span class="variable">firefox_version</span> = <span class="variable">parseInt</span>(<span class="variable">firefox</span>.<span class="variable">split</span>(<span class="string">'/'</span>)[<span class="number integer">1</span>].<span class="variable">split</span>(<span class="string">'.'</span>)[<span class="number integer">0</span>]);
                        <span class="keyword">if</span> (<span class="variable">firefox_version</span> &<span class="variable">gt</span>; <span class="number float">3.8</span>) { <span class="comment">// Case 2 - Firefox 4</span>
                            <span class="keyword">return</span> <span class="string">'f4+'</span>
                        }
                        <span class="keyword">return</span> <span class="string">'f3'</span>
                    }
                } <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">nav_name</span> == <span class="string">'Opera'</span>) {
                    <span class="keyword">var</span> <span class="variable">opera</span> = <span class="variable">nav_agent</span>.<span class="variable">substring</span>(<span class="variable">nav_agent</span>.<span class="variable">indexOf</span>(<span class="string">'Version'</span>)).<span class="variable">split</span>(&<span class="variable">quot</span>;/&<span class="variable">quot</span>;)[<span class="number integer">1</span>]
                    <span class="keyword">if</span> (<span class="variable">opera</span>.<span class="variable">split</span>(<span class="string">'.'</span>)[<span class="number integer">1</span>] &<span class="variable">gt</span>; <span class="number integer">49</span>) { <span class="comment">// Case 4 - Opera 10.5+</span>
                        <span class="keyword">return</span> <span class="string">'o10.5+'</span>
                    }
                    <span class="keyword">return</span> <span class="string">'o10.4'</span>;
                } <span class="keyword">else</span> <span class="keyword">if</span> (<span class="regexp">/MSIE (\d+\.\d+);/</span>.<span class="variable">test</span>(<span class="variable">nav_agent</span>)) { <span class="comment">//test for MSIE x.x;</span>
                    <span class="keyword">var</span> <span class="variable">ie</span> = <span class="keyword">new</span> <span class="class">Number</span>(<span class="class">RegExp</span>.$<span class="number integer">1</span>) <span class="comment">// capture x.x portion and store as a number</span>
                    <span class="keyword">if</span> (<span class="variable">ie</span> &<span class="variable">gt</span>; <span class="number integer">8</span>) {
                        <span class="keyword">return</span> <span class="string">'ie9+'</span>;
                    } <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">ie</span> == <span class="number integer">8</span>) {
                        <span class="keyword">return</span> <span class="string">'ie8'</span>;
                    }
                    <span class="keyword">return</span> <span class="string">'ie7'</span>;
                } <span class="keyword">else</span> { <span class="comment">// Case 6 - IE or other</span>
                    <span class="keyword">return</span> <span class="string">'other'</span>;
                }
            },

            <span class="string">'isIE'</span>: <span class="keyword">function</span>() {
                <span class="keyword">return</span> <span class="this">this</span>.<span class="variable">browser</span>() === <span class="string">'ie9+'</span> || <span class="this">this</span>.<span class="variable">browser</span>() === <span class="string">'ie8'</span> || <span class="this">this</span>.<span class="variable">browser</span>() === <span class="string">'ie7'</span>;
            },

            <span class="string">'isIEolder'</span>: <span class="keyword">function</span>() {
                <span class="keyword">return</span> <span class="this">this</span>.<span class="variable">browser</span>() === <span class="string">'ie8'</span> || <span class="this">this</span>.<span class="variable">browser</span>() === <span class="string">'ie7'</span>;
            },

            <span class="string">'isFirefox'</span>: <span class="keyword">function</span>() {
                <span class="keyword">return</span> <span class="this">this</span>.<span class="variable">browser</span>() === &<span class="variable">quot</span>;<span class="variable">f3</span>&<span class="variable">quot</span>; || <span class="this">this</span>.<span class="variable">browser</span>() === &<span class="variable">quot</span>;<span class="variable">f4</span>+&<span class="variable">quot</span>;
            },

            <span class="string">'isChrome'</span>: <span class="keyword">function</span>() {
                <span class="keyword">return</span> <span class="this">this</span>.<span class="variable">browser</span>() === <span class="string">'webkit'</span>
            },

            <span class="string">'querySelectorAll'</span>: <span class="keyword">function</span>() {
                <span class="keyword">return</span> (<span class="variable">tiramisu</span>.<span class="variable">selector</span> === <span class="string">'QSA'</span> &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="keyword">typeof</span> <span class="variable">tiramisu</span>.<span class="variable">d</span>.<span class="variable">querySelectorAll</span> !== <span class="string">'undefined'</span>)
            },

            <span class="string">'color'</span>: <span class="keyword">function</span>() {
                <span class="keyword">if</span> (<span class="this">this</span>.<span class="variable">isIEolder</span>()) {
                    <span class="keyword">return</span> <span class="variable">false</span>;
                }
                <span class="keyword">return</span> <span class="variable">true</span>;
            }
        };
        <span class="keyword">return</span> <span class="variable">tests</span>[<span class="variable">key</span>]();
    };</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<h1>Framework Selector Module</h1>

<p>A CSS Parser for handling DOM elements.</p>

<h2>Usage</h2>

<pre><code>tiramisu.get(*SELECTOR*)</code></pre>

<p>or</p>

<pre><code>t.get(*SELECTOR*)</code></pre>

<p>where <em>SELECTOR</em> is a <em>valid</em> CSS selector or, alternatively, an object
(see examples below).</p>

<p>Tiramisu will use <em>querySelectorAll</em> if the current browser implements it;
if not present <strong>Tiramisu</strong> fallback to a custom, simple CSS selector.</p>

<p>This simple selector implementation is <em>cross-browser</em> and actually implements
the following CSS rules:</p>

<ul><li><em>id and name</em>;</li><li><em>id</em>;</li><li><em>class</em>;</li><li><em>name and class</em>;</li><li><em>element</em>;</li></ul>

<p>Note that this implementation is not fast as <em>querySelectorAll</em> since it relies
on pure (<em>not optimized</em>) JavaScript.</p>

<h2>Example #1 (Select all li elements)</h2>

<pre><code>&lt;ul id="myList"&gt;
  &lt;li&gt; First. &lt;/li&gt;
  &lt;li&gt; Second. &lt;/li&gt;
  &lt;li&gt; Third. &lt;/li&gt;
&lt;/ul&gt;
...
var li = tiramisu.get('#myList li');</code></pre>

<h2>Example #2 (Select all li with class “special”)</h2>

<pre><code>&lt;ul id="myList"&gt;
  &lt;li&gt; First. &lt;/li&gt;
  &lt;li class="special"&gt; Second. &lt;/li&gt;
  &lt;li&gt; Third. &lt;/li&gt;
&lt;/ul&gt;
...
var li_special1 = tiramisu.get('#myList .special');

// Better way to do it :)
var li_special2 = tiramisu.get('#myList li.special');</code></pre>

<h2></h2>

<ul><li><p><strong>param</strong>: <em>String</em>  selector A CSS Selector</p></li><li><p><strong>returns</strong>: <em>Object</em>  The node list</p></li><li><p><strong>api</strong>: <em>public</em></p><p> </p></li></ul>
</td>
<td class="code">
<pre><code><span class="class">Tiramisu</span>.<span class="variable">prototype</span>.<span class="variable">get</span> = <span class="keyword">function</span>(<span class="variable">selector</span>) {

        <span class="comment">// DOM Node insertion generic utility</span>

        <span class="keyword">function</span> <span class="variable">insert_content</span>(<span class="variable">html</span>, <span class="variable">before</span>, <span class="variable">append</span>) {
            <span class="keyword">if</span> (<span class="variable">results</span>[<span class="number integer">0</span>] == <span class="variable">undefined</span>) {
                <span class="keyword">return</span> <span class="string">''</span>;
            }
            <span class="keyword">var</span> <span class="variable">i</span>, <span class="variable">parent</span>, <span class="variable">div</span>, <span class="variable">ele</span>;
            <span class="keyword">for</span> (<span class="variable">i</span> = <span class="number integer">0</span>; <span class="variable">i</span> &<span class="variable">lt</span>; <span class="variable">len_result</span>; <span class="variable">i</span>++) {
                <span class="variable">div</span> = <span class="variable">t</span>.<span class="variable">d</span>.<span class="variable">createElement</span>(<span class="string">'div'</span>)
                <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable">html</span> === <span class="string">'string'</span>) {
                    <span class="variable">div</span>.<span class="variable">innerHTML</span> = <span class="variable">html</span>;
                } <span class="keyword">else</span> {
                    <span class="variable">div</span>.<span class="variable">innerHTML</span> = <span class="variable">html</span>.<span class="variable">outerHTML</span> || <span class="keyword">new</span> <span class="class">XMLSerializer</span>().<span class="variable">serializeToString</span>(<span class="variable">html</span>)
                }
                <span class="variable">parent</span> = <span class="variable">results</span>[<span class="variable">i</span>].<span class="variable">parentNode</span>;
                <span class="keyword">while</span> (<span class="variable">ele</span> = <span class="variable">div</span>.<span class="variable">firstChild</span>) {
                    <span class="keyword">if</span> (<span class="variable">before</span>) {
                        <span class="comment">// Insert before</span>
                        (<span class="variable">append</span>) ? <span class="variable">results</span>[<span class="variable">i</span>].<span class="variable">insertBefore</span>(<span class="variable">ele</span>, <span class="variable">results</span>[<span class="variable">i</span>].<span class="variable">firstChild</span>) : <span class="variable">parent</span>.<span class="variable">insertBefore</span>(<span class="variable">ele</span>, <span class="variable">results</span>[<span class="variable">i</span>]);
                    } <span class="keyword">else</span> {
                        <span class="comment">// Insert after</span>
                        (<span class="variable">append</span>) ? <span class="variable">results</span>[<span class="variable">i</span>].<span class="variable">appendChild</span>(<span class="variable">ele</span>) : <span class="variable">parent</span>.<span class="variable">insertBefore</span>(<span class="variable">ele</span>, <span class="variable">results</span>[<span class="variable">i</span>].<span class="variable">nextSibling</span>);
                    }
                }
            }
        }

        <span class="keyword">var</span> <span class="variable">macros</span> = {
            <span class="string">'nl'</span>: <span class="string">'\n|\r\n|\r|\f'</span>,
            <span class="string">'nonascii'</span>: <span class="string">'[^\0-\177]'</span>,
            <span class="string">'unicode'</span>: <span class="string">'\\[0-9A-Fa-f]{1,6}(\r\n|[\s\n\r\t\f])?'</span>,
            <span class="string">'escape'</span>: <span class="string">'#{unicode}|\\[^\n\r\f0-9A-Fa-f]'</span>,
            <span class="string">'nmchar'</span>: <span class="string">'[_A-Za-z0-9-]|#{nonascii}|#{escape}'</span>,
            <span class="string">'nmstart'</span>: <span class="string">'[_A-Za-z]|#{nonascii}|#{escape}'</span>,
            <span class="string">'ident'</span>: <span class="string">'[-@]?(#{nmstart})(#{nmchar})*'</span>,
            <span class="string">'name'</span>: <span class="string">'(#{nmchar})+'</span>
        };

        <span class="keyword">var</span> <span class="variable">rules</span> = {
            <span class="string">'id and name'</span>: <span class="string">'(#{ident}##{ident})'</span>,
            <span class="string">'id'</span>: <span class="string">'(##{ident})'</span>,
            <span class="string">'class'</span>: <span class="string">'(\\.#{ident})'</span>,
            <span class="string">'name and class'</span>: <span class="string">'(#{ident}\\.#{ident})'</span>,
            <span class="string">'element'</span>: <span class="string">'(#{ident})'</span>,
            <span class="string">'pseudo class'</span>: <span class="string">'(:#{ident})'</span>
        };

        <span class="comment">// Normalize the selector</span>

        <span class="keyword">function</span> <span class="variable">normalize</span>(<span class="variable">text</span>) {
            <span class="keyword">return</span> <span class="variable">text</span>.<span class="variable">replace</span>(<span class="regexp">/^\s+|\s+$/g</span>, <span class="string">''</span>).<span class="variable">replace</span>(<span class="regexp">/[ \t\r\n\f]+/g</span>, <span class="string">' '</span>);
        }

        <span class="comment">// Scan macros and rules to build a big regex</span>
        <span class="keyword">var</span> <span class="variable">scanner</span> = <span class="keyword">function</span>() {
                <span class="keyword">function</span> <span class="variable">replacePattern</span>(<span class="variable">pattern</span>, <span class="variable">patterns</span>) {
                    <span class="keyword">var</span> <span class="variable">matched</span> = <span class="variable">true</span>,
                        <span class="variable">match</span>;
                    <span class="keyword">while</span> (<span class="variable">matched</span>) {
                        <span class="variable">match</span> = <span class="variable">pattern</span>.<span class="variable">match</span>(<span class="regexp">/#\{([^}]+)\}/</span>);
                        <span class="keyword">if</span> (<span class="variable">match</span> &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="variable">match</span>[<span class="number integer">1</span>]) {
                            <span class="variable">pattern</span> = <span class="variable">pattern</span>.<span class="variable">replace</span>(<span class="keyword">new</span> <span class="class">RegExp</span>(<span class="string">'#\{'</span> + <span class="variable">match</span>[<span class="number integer">1</span>] + <span class="string">'\}'</span>, <span class="string">'g'</span>), <span class="variable">patterns</span>[<span class="variable">match</span>[<span class="number integer">1</span>]]);
                            <span class="variable">matched</span> = <span class="variable">true</span>;
                        } <span class="keyword">else</span> {
                            <span class="variable">matched</span> = <span class="variable">false</span>;
                        }
                    }
                    <span class="keyword">return</span> <span class="variable">pattern</span>;
                }

                <span class="keyword">function</span> <span class="variable">escapePattern</span>(<span class="variable">text</span>) {
                    <span class="keyword">return</span> <span class="variable">text</span>.<span class="variable">replace</span>(<span class="regexp">/\/</span><span class="regexp">/g, '/</span>/');
                }

                <span class="keyword">function</span> <span class="variable">convertPatterns</span>() {
                    <span class="keyword">var</span> <span class="variable">key</span>, <span class="variable">pattern</span>, <span class="variable">results</span> = {},
                        <span class="variable">patterns</span>, <span class="variable">source</span>;

                    <span class="keyword">if</span> (<span class="variable">arguments</span>.<span class="variable">length</span> === <span class="number integer">2</span>) {
                        <span class="variable">source</span> = <span class="variable">arguments</span>[<span class="number integer">0</span>];
                        <span class="variable">patterns</span> = <span class="variable">arguments</span>[<span class="number integer">1</span>]
                    } <span class="keyword">else</span> {
                        <span class="variable">source</span> = <span class="variable">arguments</span>[<span class="number integer">0</span>];
                        <span class="variable">patterns</span> = <span class="variable">arguments</span>[<span class="number integer">0</span>];
                    }

                    <span class="keyword">for</span> (<span class="variable">key</span> <span class="keyword">in</span> <span class="variable">patterns</span>) {
                        <span class="variable">pattern</span> = <span class="variable">escapePattern</span>(<span class="variable">replacePattern</span>(<span class="variable">patterns</span>[<span class="variable">key</span>], <span class="variable">source</span>));
                        <span class="variable">results</span>[<span class="variable">key</span>] = <span class="variable">pattern</span>;
                    }
                    <span class="keyword">return</span> <span class="variable">results</span>;
                }

                <span class="keyword">function</span> <span class="variable">joinPatterns</span>(<span class="variable">regexps</span>) {
                    <span class="keyword">var</span> <span class="variable">results</span> = [],
                        <span class="variable">key</span>;

                    <span class="keyword">for</span> (<span class="variable">key</span> <span class="keyword">in</span> <span class="variable">regexps</span>) {
                        <span class="variable">results</span>.<span class="variable">push</span>(<span class="variable">regexps</span>[<span class="variable">key</span>]);
                    }

                    <span class="keyword">return</span> <span class="keyword">new</span> <span class="class">RegExp</span>(<span class="variable">results</span>.<span class="variable">join</span>(<span class="string">'|'</span>), <span class="string">'g'</span>);
                }

                <span class="keyword">return</span> <span class="variable">joinPatterns</span>(<span class="variable">convertPatterns</span>(<span class="variable">convertPatterns</span>(<span class="variable">macros</span>), <span class="variable">rules</span>));
            };

        <span class="keyword">var</span> <span class="variable">filter</span> = {
            <span class="string">'byAttr'</span>: <span class="keyword">function</span>(<span class="variable">elements</span>, <span class="variable">attribute</span>, <span class="variable">value</span>) {
                <span class="keyword">var</span> <span class="variable">key</span>, <span class="variable">results</span> = [];
                <span class="keyword">for</span> (<span class="variable">key</span> <span class="keyword">in</span> <span class="variable">elements</span>) {
                    <span class="keyword">if</span> (<span class="variable">elements</span>[<span class="variable">key</span>] &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="variable">elements</span>[<span class="variable">key</span>][<span class="variable">attribute</span>] === <span class="variable">value</span>) {
                        <span class="variable">results</span>.<span class="variable">push</span>(<span class="variable">elements</span>[<span class="variable">key</span>]);
                    }
                }
                <span class="keyword">return</span> <span class="variable">results</span>;
            }
        };

        <span class="keyword">var</span> <span class="variable">find</span> = {
            <span class="string">'byId'</span>: <span class="keyword">function</span>(<span class="variable">root</span>, <span class="variable">id</span>) {
                <span class="keyword">return</span> (<span class="variable">root</span>) ? [<span class="variable">root</span>.<span class="variable">getElementById</span>(<span class="variable">id</span>)] : [];
            },

            <span class="string">'byNodeName'</span>: <span class="keyword">function</span>(<span class="variable">root</span>, <span class="variable">tagName</span>) {
                <span class="keyword">if</span> (<span class="variable">root</span> === <span class="keyword">null</span>) <span class="keyword">return</span> [];
                <span class="keyword">var</span> <span class="variable">i</span>, <span class="variable">results</span> = [],
                    <span class="variable">nodes</span> = <span class="variable">root</span>.<span class="variable">getElementsByTagName</span>(<span class="variable">tagName</span>);

                <span class="keyword">for</span> (<span class="variable">i</span> = <span class="number integer">0</span>; <span class="variable">i</span> &<span class="variable">lt</span>; <span class="variable">nodes</span>.<span class="variable">length</span>; <span class="variable">i</span>++) {
                    <span class="variable">results</span>.<span class="variable">push</span>(<span class="variable">nodes</span>[<span class="variable">i</span>]);
                }
                <span class="keyword">return</span> <span class="variable">results</span>;
            },

            <span class="string">'byClassName'</span>: <span class="keyword">function</span>(<span class="variable">root</span>, <span class="variable">className</span>) {
                <span class="keyword">if</span> (<span class="variable">root</span> === <span class="keyword">null</span>) <span class="keyword">return</span> [];
                <span class="keyword">var</span> <span class="variable">i</span>, <span class="variable">results</span> = [],
                    <span class="variable">nodes</span> = <span class="variable">root</span>.<span class="variable">getElementsByTagName</span>(<span class="string">'*'</span>);

                <span class="keyword">for</span> (<span class="variable">i</span> = <span class="number integer">0</span>; <span class="variable">i</span> &<span class="variable">lt</span>; <span class="variable">nodes</span>.<span class="variable">length</span>; <span class="variable">i</span>++) {
                    <span class="keyword">if</span> (<span class="variable">nodes</span>[<span class="variable">i</span>].<span class="variable">className</span>.<span class="variable">match</span>(<span class="string">'\\b'</span> + <span class="variable">className</span> + <span class="string">'\\b'</span>)) {
                        <span class="variable">results</span>.<span class="variable">push</span>(<span class="variable">nodes</span>[<span class="variable">i</span>]);
                    }
                }
                <span class="keyword">return</span> <span class="variable">results</span>;
            }
        };

        <span class="keyword">var</span> <span class="variable">findMap</span> = {
            <span class="string">'id'</span>: <span class="keyword">function</span>(<span class="variable">root</span>, <span class="variable">selector</span>) {
                <span class="variable">selector</span> = <span class="variable">selector</span>.<span class="variable">split</span>(<span class="string">'#'</span>)[<span class="number integer">1</span>];
                <span class="keyword">return</span> <span class="variable">find</span>.<span class="variable">byId</span>(<span class="variable">root</span>, <span class="variable">selector</span>);
            },

            <span class="string">'name and id'</span>: <span class="keyword">function</span>(<span class="variable">root</span>, <span class="variable">selector</span>) {
                <span class="keyword">var</span> <span class="variable">matches</span> = <span class="variable">selector</span>.<span class="variable">split</span>(<span class="string">'#'</span>),
                    <span class="variable">name</span> = <span class="variable">matches</span>[<span class="number integer">0</span>],
                    <span class="variable">id</span> = <span class="variable">matches</span>[<span class="number integer">1</span>];
                <span class="keyword">return</span> <span class="variable">filter</span>.<span class="variable">byAttr</span>(<span class="variable">find</span>.<span class="variable">byId</span>(<span class="variable">root</span>, <span class="variable">id</span>), <span class="string">'nodeName'</span>, <span class="variable">name</span>.<span class="variable">toUpperCase</span>());
            },

            <span class="string">'name'</span>: <span class="keyword">function</span>(<span class="variable">root</span>, <span class="variable">selector</span>) {
                <span class="keyword">return</span> <span class="variable">find</span>.<span class="variable">byNodeName</span>(<span class="variable">root</span>, <span class="variable">selector</span>);
            },

            <span class="string">'class'</span>: <span class="keyword">function</span>(<span class="variable">root</span>, <span class="variable">selector</span>) {
                <span class="variable">selector</span> = <span class="variable">selector</span>.<span class="variable">split</span>(<span class="string">'\.'</span>)[<span class="number integer">1</span>];
                <span class="keyword">return</span> <span class="variable">find</span>.<span class="variable">byClassName</span>(<span class="variable">root</span>, <span class="variable">selector</span>);
            },

            <span class="string">'name and class'</span>: <span class="keyword">function</span>(<span class="variable">root</span>, <span class="variable">selector</span>) {
                <span class="keyword">var</span> <span class="variable">matches</span> = <span class="variable">selector</span>.<span class="variable">split</span>(<span class="string">'\.'</span>),
                    <span class="variable">name</span> = <span class="variable">matches</span>[<span class="number integer">0</span>],
                    <span class="variable">className</span> = <span class="variable">matches</span>[<span class="number integer">1</span>];
                <span class="keyword">return</span> <span class="variable">filter</span>.<span class="variable">byAttr</span>(<span class="variable">find</span>.<span class="variable">byClassName</span>(<span class="variable">root</span>, <span class="variable">className</span>), <span class="string">'nodeName'</span>, <span class="variable">name</span>.<span class="variable">toUpperCase</span>());
            }
        };

        <span class="keyword">var</span> <span class="variable">matchMap</span> = {
            <span class="string">'id'</span>: <span class="keyword">function</span>(<span class="variable">element</span>, <span class="variable">selector</span>) {
                <span class="variable">selector</span> = <span class="variable">selector</span>.<span class="variable">split</span>(<span class="string">'#'</span>)[<span class="number integer">1</span>];
                <span class="keyword">return</span> <span class="variable">element</span> &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="variable">element</span>.<span class="variable">id</span> === <span class="variable">selector</span>;
            },

            <span class="string">'name'</span>: <span class="keyword">function</span>(<span class="variable">element</span>, <span class="variable">nodeName</span>) {
                <span class="keyword">return</span> <span class="variable">element</span>.<span class="variable">nodeName</span> === <span class="variable">nodeName</span>.<span class="variable">toUpperCase</span>();
            },

            <span class="string">'name and id'</span>: <span class="keyword">function</span>(<span class="variable">element</span>, <span class="variable">selector</span>) {
                <span class="keyword">return</span> <span class="variable">matchMap</span>.<span class="variable">id</span>(<span class="variable">element</span>, <span class="variable">selector</span>) &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="variable">matchMap</span>.<span class="variable">name</span>(<span class="variable">element</span>, <span class="variable">selector</span>.<span class="variable">split</span>(<span class="string">'#'</span>)[<span class="number integer">0</span>]);
            },

            <span class="string">'class'</span>: <span class="keyword">function</span>(<span class="variable">element</span>, <span class="variable">selector</span>) {
                <span class="keyword">if</span> (<span class="variable">element</span> &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="variable">element</span>.<span class="variable">className</span>) {
                    <span class="variable">selector</span> = <span class="variable">selector</span>.<span class="variable">split</span>(<span class="string">'\.'</span>)[<span class="number integer">1</span>];
                    <span class="keyword">return</span> <span class="variable">element</span>.<span class="variable">className</span>.<span class="variable">match</span>(<span class="string">'\\b'</span> + <span class="variable">selector</span> + <span class="string">'\\b'</span>);
                }
            },

            <span class="string">'name and class'</span>: <span class="keyword">function</span>(<span class="variable">element</span>, <span class="variable">selector</span>) {
                <span class="keyword">return</span> <span class="variable">matchMap</span>[<span class="string">'class'</span>](<span class="variable">element</span>, <span class="variable">selector</span>) &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="variable">matchMap</span>.<span class="variable">name</span>(<span class="variable">element</span>, <span class="variable">selector</span>.<span class="variable">split</span>(<span class="string">'\.'</span>)[<span class="number integer">0</span>]);
            }
        };</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<h2>Each iterator extension</h2>

<p>Applies a callback function to a list of DOM nodes.</p>

<h2>Usage</h2>

<pre><code>tiramisu.get(*SELECTOR*).each(*CALLBACK*)</code></pre>

<p>Where <em>SELECTOR</em> is a valid CSS selector and <em>CALLBACK</em> a
function object.</p>

<p>It is common to retrieve a list of DOM nodes and then apply the
<em>same</em> function to all of it's element:</p>

<h2>Example #1 (alert the innerHTML of every element in a list)</h2>

<pre><code>&lt;ul&gt;
  &lt;li&gt; One. &lt;/li&gt;
  &lt;li&gt; Two. &lt;/li&gt;
  &lt;li&gt; Three. &lt;/li&gt;
&lt;/ul&gt;
...
tiramisu.get('ul li').each(function() {
    alert(this.innerHTML);
});</code></pre>

<p>As you can see, <strong>this</strong> is used for referencing the current
iteration item.</p>

<h2></h2>

<ul><li><p><strong>param</strong>: <em>function</em>  cb The callback function to apply</p><pre><code>     </code></pre></li></ul>
</td>
<td class="code">
<pre><code><span class="string">'each'</span>: <span class="keyword">function</span>(<span class="variable">cb</span>) {
                <span class="keyword">var</span> <span class="variable">i</span>;
                <span class="keyword">for</span> (<span class="variable">i</span> = <span class="number integer">0</span>; <span class="variable">i</span> &<span class="variable">lt</span>; <span class="variable">len_result</span>; <span class="variable">i</span>++) {
                    <span class="variable">cb</span>.<span class="variable">apply</span>(<span class="variable">results</span>[<span class="variable">i</span>]);
                }
                <span class="keyword">return</span> <span class="this">this</span>;
            },</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<h2>Event handler extension</h2>

<p>Attach a callback function to an event.</p>

<h2>Usage</h2>

<pre><code>tiramisu.get(*SELECTOR*).on(*EVENT*, *CALLBACK*)</code></pre>

<p>where <em>SELECTOR</em> is a valid CSS selector, <em>EVENT</em> is
the event listener and <em>CALLBACK</em> the function to attach.</p>

<h2>Example #1 (Clicking on a p element displays “Hello!”)</h2>

<pre><code>&lt;p&gt; Click me! &lt;/p&gt;
&lt;p&gt; Click me too! &lt;/p&gt;
&lt;p&gt; And me? &lt;/p&gt;
...
tiramisu.get('p').on('click', function() {
    alert('Hello!');
});</code></pre>

<h2>Example #2 (Hovering on a li element displays his innerHTML)</h2>

<pre><code> &lt;ol&gt;
   &lt;li&gt; Banana &lt;/li&gt;
   &lt;li&gt; Apple &lt;/li&gt;
   &lt;li&gt; Pineapple &lt;/li&gt;
   &lt;li&gt; Strawberry &lt;/li&gt;
 &lt;/ol&gt;
 ...
 tiramisu.get('ul li').on('mouseover', function() {
     alert(this.innerHTML);
 });</code></pre>

<p> As in the “each” example, it is possible to use <strong>this</strong> to
 reference the current list item.</p>

<h2>Example #3 (Defining a window.onload callback)</h2>

<pre><code>tiramisu.get(window).on('load', function() {
    alert('This will be executed after the DOM loading");
});</code></pre>

<h2>Example #4 (Alert message when pressing the “m” key)</h2>

<pre><code>tiramisu.get(document).on('keydown', function(evt) {
    if (evt.keyCode == 77) {
        alert("M as Marvelous!");
    }
});</code></pre>

<h2>Example #5 ()</h2>

<pre><code>tiramisu.get('p').on('keydown', 'click', function(evt) {
    alert('This will be executed after click or keydown on 'p' element");
});</code></pre>

<h2></h2>

<ul><li><p><strong>param</strong>: <em>event</em>  evt An event listener</p></li><li><p><strong>param</strong>: <em>function</em>  cb The callback function to attach</p><pre><code>     </code></pre></li></ul>
</td>
<td class="code">
<pre><code><span class="string">'on'</span>: <span class="keyword">function</span>(<span class="variable">evt</span>, <span class="variable">cb</span>) {
                <span class="keyword">if</span> (<span class="variable">results</span>[<span class="number integer">0</span>] == <span class="variable">undefined</span> || <span class="variable">arguments</span>.<span class="variable">length</span> &<span class="variable">gt</span>; <span class="number integer">2</span>) {
                    <span class="keyword">return</span> <span class="string">''</span>;
                }
                <span class="keyword">var</span> <span class="variable">evt_len</span> = <span class="number integer">1</span>,
                    <span class="variable">ev</span> = [],
                    <span class="variable">callback</span> = [];
                <span class="keyword">if</span> (<span class="keyword">typeof</span>(<span class="variable">evt</span>) === <span class="string">'string'</span>) {
                    <span class="variable">ev</span>[<span class="number integer">0</span>] = <span class="variable">evt</span>;
                    <span class="variable">callback</span>[<span class="number integer">0</span>] = <span class="variable">cb</span>;
                } <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span>(<span class="variable">evt</span>) === <span class="string">'object'</span>) {
                    <span class="keyword">if</span> (<span class="keyword">typeof</span>(<span class="variable">evt</span>[<span class="number integer">0</span>]) === <span class="string">'string'</span>) {
                        <span class="variable">ev</span> = <span class="variable">evt</span>;
                        <span class="variable">callback</span>[<span class="number integer">0</span>] = <span class="variable">cb</span>;
                    } <span class="keyword">else</span> {
                        <span class="keyword">for</span> (<span class="variable">key</span> <span class="keyword">in</span> <span class="variable">evt</span>) {
                            <span class="variable">evt_len</span> = <span class="variable">ev</span>.<span class="variable">push</span>(<span class="variable">key</span>);
                            <span class="variable">callback</span>.<span class="variable">push</span>(<span class="variable">evt</span>[<span class="variable">key</span>]);
                        }
                    }
                }
                <span class="comment">// if results[0] === undefined : *SELECTOR* is not a valid CSS selector or not exist;)</span>
                <span class="keyword">for</span> (<span class="keyword">var</span> <span class="variable">j</span> = <span class="variable">evt_len</span>; <span class="variable">j</span>--;) {
                    <span class="keyword">if</span> (<span class="variable">results</span>[<span class="number integer">0</span>].<span class="variable">addEventListener</span>) {
                        <span class="keyword">for</span> (<span class="variable">i</span> = <span class="variable">len_result</span>; <span class="variable">i</span>--;) {
                            <span class="variable">results</span>[<span class="variable">i</span>].<span class="variable">addEventListener</span>(<span class="variable">ev</span>[<span class="variable">j</span>], <span class="variable">callback</span>[<span class="variable">j</span>], <span class="variable">false</span>);
                        }
                    } <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">results</span>[<span class="number integer">0</span>].<span class="variable">attachEvent</span>) {
                        <span class="keyword">for</span> (<span class="variable">i</span> = <span class="variable">len_result</span>; <span class="variable">i</span>--;) {
                            <span class="variable">results</span>[<span class="variable">i</span>].<span class="variable">attachEvent</span>(<span class="string">'on'</span> + <span class="variable">ev</span>[<span class="variable">j</span>], <span class="variable">callback</span>[<span class="variable">j</span>]);
                        }
                    }
                }
                <span class="keyword">return</span> <span class="this">this</span>;
            },</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<h2>Insert Before method</h2>

<p>Insert text or html, before each element.</p>

<h2>Usage</h2>

<pre><code>tiramisu.get(*SELECTOR*).before(*HTML*)</code></pre>

<p>where <em>SELECTOR</em> is a valid CSS selector, <em>HTML</em> is
the element to insert.</p>

<h2>Example #1 ()</h2>

<pre><code>&lt;h1&gt;Hello Tiramisu&lt;/h1&gt;
&lt;div class="inner"&gt;ciao&lt;/div&gt;
&lt;div class="inner"&gt;mondo&lt;/div&gt;
...
t.get('.inner').before('&lt;p&gt;ciccio&lt;/p&gt;')

produce the following result:

&lt;h1&gt;Hello Tiramisu&lt;/h1&gt;
&lt;p&gt;ciccio&lt;/p&gt;
&lt;div class="inner"&gt;ciao&lt;/div&gt;
&lt;p&gt;ciccio&lt;/p&gt;
&lt;div class="inner"&gt;mondo&lt;/div&gt;</code></pre>

<h2></h2>

<ul><li><p><strong>param</strong>: <em>html</em>  The element to insert</p><pre><code>     </code></pre></li></ul>
</td>
<td class="code">
<pre><code><span class="string">'before'</span>: <span class="keyword">function</span>(<span class="variable">html</span>) {
                <span class="variable">insert_content</span>(<span class="variable">html</span>, <span class="variable">true</span>, <span class="variable">false</span>)
                <span class="keyword">return</span> <span class="this">this</span>;
            },</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<h2>Insert After method</h2>

<p>Insert text or html, after each element.</p>

<h2>Usage</h2>

<pre><code>tiramisu.get(*SELECTOR*).after(*HTML*)</code></pre>

<p>where <em>SELECTOR</em> is a valid CSS selector and <em>HTML</em> is
the element to insert.</p>

<h2>Example #1 (Inserting an element multiple times)</h2>

<pre><code>&lt;h1&gt;Hello Tiramisu&lt;/h1&gt;
&lt;div class="inner"&gt;ciao&lt;/div&gt;
&lt;div class="inner"&gt;mondo&lt;/div&gt;
...
t.get('.inner').after('&lt;p&gt;ciccio&lt;/p&gt;')

produces the following result:

&lt;h1&gt;Hello Tiramisu&lt;/h1&gt;
&lt;div class="inner"&gt;ciao&lt;/div&gt;
&lt;p&gt;ciccio&lt;/p&gt;
&lt;div class="inner"&gt;mondo&lt;/div&gt;
&lt;p&gt;ciccio&lt;/p&gt;</code></pre>

<h2></h2>

<ul><li><p><strong>param</strong>: <em>html</em>  The element to insert</p><pre><code>     </code></pre></li></ul>
</td>
<td class="code">
<pre><code><span class="string">'after'</span>: <span class="keyword">function</span>(<span class="variable">html</span>) {
                <span class="variable">insert_content</span>(<span class="variable">html</span>, <span class="variable">false</span>, <span class="variable">false</span>);
                <span class="keyword">return</span> <span class="this">this</span>;
            },</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<h2>Append method</h2>

<p>Appends a DOM element into a list of selector results.</p>

<h2>Usage</h2>

<pre><code>tiramisu.get(*SELECTOR*).append(*HTML*)</code></pre>

<p>where <em>SELECTOR</em> is a valid CSS selector and <em>HTML</em> is
a string containing some HTML (such as "&lt;p&gt;hi&lt;/p&gt;,
&lt;h1&gt;headline&lt;/h1&gt; etc.)</p>

<h2>Example #1 (Append a single element)</h2>

<pre><code>&lt;ul&gt;
  &lt;li&gt;One&lt;/li&gt;
  &lt;li&gt;Two&lt;/li&gt;
&lt;/ul&gt;
...
t.get('ul').append('&lt;li&gt;Three&lt;/li&gt;');

produces the following:

&lt;ul&gt;
  &lt;li&gt;One&lt;/li&gt;
  &lt;li&gt;Two&lt;/li&gt;
  &lt;li&gt;Three&lt;/li&gt;
&lt;/ul&gt;</code></pre>

<h2>Example #2 (Append multiple elements)</h2>

<pre><code> &lt;ul&gt;
   &lt;li&gt;
     &lt;p&gt;One&lt;/p&gt;
   &lt;/li&gt;
   &lt;li&gt;
     &lt;p&gt;Two&lt;/p&gt;
   &lt;/li&gt;
 &lt;/ul&gt;
 ...
 t.get('ul li').append('&lt;p&gt;append&lt;/p&gt;');

 produces the following:

 &lt;ul&gt;
   &lt;li&gt;
     &lt;p&gt;One&lt;/p&gt;
     &lt;p&gt;append&lt;/p&gt;
   &lt;/li&gt;
   &lt;li&gt;
     &lt;p&gt;Two&lt;/p&gt;
     &lt;p&gt;append&lt;/p&gt;
   &lt;/li&gt;
 &lt;/ul&gt;</code></pre>

<h2></h2>

<ul><li><p><strong>param</strong>: <em>html</em>  The element to append</p><pre><code>     </code></pre></li></ul>
</td>
<td class="code">
<pre><code><span class="string">'append'</span>: <span class="keyword">function</span>(<span class="variable">html</span>) {
                <span class="variable">insert_content</span>(<span class="variable">html</span>, <span class="variable">false</span>, <span class="variable">true</span>);
                <span class="keyword">return</span> <span class="this">this</span>;
            },</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<h2>Prepend method</h2>

<p>Prepends a DOM element into a list of selector results.</p>

<h2>Usage</h2>

<pre><code>tiramisu.get(*SELECTOR*).prepend(*HTML*)</code></pre>

<p>where <em>SELECTOR</em> is a valid CSS selector and <em>HTML</em> is
a string containing some HTML (such as "&lt;p&gt;hi&lt;/p&gt;,
&lt;h1&gt;headline&lt;/h1&gt; etc.)</p>

<h2>Example #1 (Prepend a single element)</h2>

<pre><code>&lt;ul&gt;
  &lt;li&gt;One&lt;/li&gt;
  &lt;li&gt;Two&lt;/li&gt;
&lt;/ul&gt;
...
t.get('ul').prepend('&lt;li&gt;Three&lt;/li&gt;');

produces the following:

&lt;ul&gt;
  &lt;li&gt;Zero&lt;/li&gt;
  &lt;li&gt;One&lt;/li&gt;
  &lt;li&gt;Two&lt;/li&gt;
&lt;/ul&gt;</code></pre>

<h2>Example #2 (Prepend multiple elements)</h2>

<pre><code> &lt;ul&gt;
   &lt;li&gt;
     &lt;p&gt;One&lt;/p&gt;
   &lt;/li&gt;
   &lt;li&gt;
     &lt;p&gt;Two&lt;/p&gt;
   &lt;/li&gt;
 &lt;/ul&gt;
 ...
 t.get('ul li').prepend('&lt;p&gt;prepend&lt;/p&gt;');

 produces the following:

 &lt;ul&gt;
   &lt;li&gt;
     &lt;p&gt;prepend&lt;/p&gt;
     &lt;p&gt;One&lt;/p&gt;
   &lt;/li&gt;
   &lt;li&gt;
     &lt;p&gt;prepend&lt;/p&gt;
     &lt;p&gt;Two&lt;/p&gt;
   &lt;/li&gt;
 &lt;/ul&gt;</code></pre>

<h2></h2>

<ul><li><p><strong>param</strong>: <em>html</em>  The element to prepend</p><pre><code>     </code></pre></li></ul>
</td>
<td class="code">
<pre><code><span class="string">'prepend'</span>: <span class="keyword">function</span>(<span class="variable">html</span>) {
                <span class="variable">insert_content</span>(<span class="variable">html</span>, <span class="variable">true</span>, <span class="variable">true</span>);
                <span class="keyword">return</span> <span class="this">this</span>;
            },</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<h2>CSS handler extension</h2>

<p>Alter the CSS properties of a list of DOM nodes.</p>

<h2>Usage</h2>

<pre><code>tiramisu.get(*SELECTOR*).css(*CSS_PROPERTIES*)</code></pre>

<p>where <em>SELECTOR</em> is a valid CSS selector and <em>CSS_PROPERTIES</em>
is an object containing the CSS properties to set.</p>

<h2>Example #1 (Set all h1 tags to 34px with color red)</h2>

<pre><code>&lt;h1&gt; This is one headline. &lt;/h1&gt;
&lt;h1&gt; This is another headline. &lt;/h1&gt;
...
tiramisu.get('h1').css({
    'font-size': '12px',
    'color': 'red'
});</code></pre>

<h2>Example #2 (Get attribute out of style)</h2>

<pre><code>&lt;h1 id="my_id" style="color:red"&gt; This is one headline. &lt;/h1&gt;
...
tiramisu.get('#my_id').css("color")</code></pre>

<h2></h2>

<ul><li><p><strong>param</strong>: <em>Object</em>  obj An object containing CSS properties</p><pre><code>     </code></pre></li></ul>
</td>
<td class="code">
<pre><code><span class="string">'css'</span>: <span class="keyword">function</span>(<span class="variable">obj</span>) {
                <span class="keyword">var</span> <span class="variable">i</span>, <span class="variable">key</span>, <span class="variable">browser</span> = <span class="variable">t</span>.<span class="variable">detect</span>(<span class="string">'browser'</span>),
                    <span class="variable">ie_older</span> = <span class="variable">t</span>.<span class="variable">detect</span>(<span class="string">'isIEolder'</span>),
                    <span class="variable">ie</span> = <span class="variable">t</span>.<span class="variable">detect</span>(<span class="string">'isIE'</span>);

                <span class="comment">// For handling IE CSS Attributes</span>
                <span class="keyword">var</span> <span class="variable">attr</span> = {
                    <span class="string">'opacity'</span>: <span class="keyword">function</span>(<span class="variable">obj</span>, <span class="variable">value</span>) {
                        <span class="keyword">if</span> (<span class="variable">value</span> !== <span class="variable">undefined</span>) {
                            <span class="comment">// Setter</span>
                            <span class="keyword">if</span> (<span class="variable">ie</span>) {
                                <span class="variable">obj</span>.<span class="variable">style</span>.<span class="variable">opacity</span> = <span class="variable">value</span>;
                                <span class="variable">obj</span>.<span class="variable">style</span>.<span class="variable">filter</span> = <span class="string">'alpha(opacity='</span> + <span class="variable">value</span> * <span class="number integer">100</span> + <span class="string">')'</span>;
                            } <span class="keyword">else</span> {
                                <span class="variable">obj</span>.<span class="variable">style</span>.<span class="variable">opacity</span> = <span class="variable">value</span>;
                            }
                        } <span class="keyword">else</span> {
                            <span class="comment">// Getter</span>
                            <span class="keyword">return</span> <span class="variable">obj</span>.<span class="variable">style</span>.<span class="variable">opacity</span>
                        }
                    },
                    <span class="string">'border-radius'</span>: <span class="keyword">function</span>(<span class="variable">obj</span>, <span class="variable">value</span>) {
                        <span class="keyword">if</span> (<span class="variable">value</span>) {
                            <span class="keyword">if</span> (<span class="variable">browser</span> === <span class="string">'f3'</span>) {
                                <span class="variable">obj</span>.<span class="variable">style</span>.<span class="class">MozBorderRadius</span> = <span class="variable">value</span>; <span class="comment">// Firefox 3.6 &lt;=</span>
                            }
                        } <span class="keyword">else</span> {
                            <span class="keyword">if</span> (<span class="variable">browser</span> === <span class="string">'f3'</span>) {
                                <span class="keyword">return</span> <span class="variable">obj</span>.<span class="variable">style</span>.<span class="class">MozBorderRadius</span>;
                            } <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">browser</span> === <span class="string">'ie9+'</span>) {
                                <span class="keyword">return</span> <span class="variable">obj</span>.<span class="variable">style</span>.<span class="variable">borderRadius</span>;
                            }
                        }
                    }
                };

                <span class="keyword">if</span> (<span class="keyword">typeof</span>(<span class="variable">obj</span>) === <span class="string">'string'</span>) {
                    <span class="keyword">if</span> (<span class="variable">ie</span> || <span class="variable">browser</span> === <span class="string">'f3'</span>) {
                        <span class="keyword">if</span> (<span class="variable">obj</span> == <span class="string">'border-radius'</span>) {
                            <span class="keyword">return</span> <span class="variable">attr</span>[<span class="variable">obj</span>](<span class="variable">results</span>[<span class="number integer">0</span>])
                        }
                        <span class="keyword">return</span> <span class="variable">results</span>[<span class="number integer">0</span>].<span class="variable">style</span>[<span class="variable">obj</span>];
                    }
                    <span class="keyword">return</span> <span class="variable">results</span>[<span class="number integer">0</span>].<span class="variable">style</span>[<span class="variable">obj</span>];
                }

                <span class="comment">// Apply to all elements</span>
                <span class="keyword">for</span> (<span class="variable">i</span> = <span class="variable">len_result</span>; <span class="variable">i</span>--;) {
                    <span class="keyword">for</span> (<span class="variable">key</span> <span class="keyword">in</span> <span class="variable">obj</span>) {
                        <span class="keyword">if</span> (<span class="variable">obj</span>.<span class="variable">hasOwnProperty</span>(<span class="variable">key</span>)) {
                            <span class="comment">// Need to handle different browsers</span>
                            <span class="keyword">if</span> (<span class="variable">ie</span> || <span class="variable">browser</span> === <span class="string">'f3'</span>) {
                                <span class="keyword">if</span> (<span class="variable">attr</span>[<span class="variable">key</span>] !== <span class="variable">undefined</span>) {
                                    <span class="variable">attr</span>[<span class="variable">key</span>](<span class="variable">results</span>[<span class="variable">i</span>], <span class="variable">obj</span>[<span class="variable">key</span>]);
                                } <span class="keyword">else</span> {
                                    <span class="comment">// No match in attr</span>
                                    <span class="variable">results</span>[<span class="variable">i</span>].<span class="variable">style</span>[<span class="variable">key</span>] = <span class="variable">obj</span>[<span class="variable">key</span>];
                                }
                            } <span class="keyword">else</span> {
                                <span class="comment">// The third param is for W3C Standard</span>
                                <span class="variable">results</span>[<span class="variable">i</span>].<span class="variable">style</span>.<span class="variable">setProperty</span>(<span class="variable">key</span>, <span class="variable">obj</span>[<span class="variable">key</span>], <span class="string">''</span>);
                            }
                        }
                    }
                }
                <span class="keyword">return</span> <span class="this">this</span>;
            },</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<h2>HTML extension method</h2>

<p>Gets or sets the HTML Markup of the first CSS
selector element.</p>

<h2>Usage</h2>

<pre><code>tiramisu.get(*SELECTOR*).html([*HTML*])</code></pre>

<p>where <em>SELECTOR</em> is a valid CSS selector and <em>[HTML]</em> is an
optional value to set the element's innerHTML value.</p>

<h2>Example #1 (Getting the HTML value of a div)</h2>

<pre><code>&lt;div id="header"&gt;
  &lt;p&gt; I love pizza! &lt;/p&gt;
&lt;/div&gt;
...
var pizza = tiramisu.get('#header').html()</code></pre>

<p>Example #2 (Setting the HTML value of a div)</p>

<pre><code>&lt;div id="header"&gt;
  &lt;p&gt; I love pizza! &lt;/p&gt;
&lt;/div&gt;
...
tiramisu.get('#header').html('&lt;p&gt; i hate cakes! &lt;/p&gt;');</code></pre>

<h2></h2>

<ul><li><p><strong>param</strong>: <em>String</em>  [set] An optional string containing the HTML to replace</p></li><li><p><strong>return</strong>: <em>[String]</em>  An optional string containing the selector's first element HTML value</p><pre><code>     </code></pre></li></ul>
</td>
<td class="code">
<pre><code><span class="string">'html'</span>: <span class="keyword">function</span>(<span class="variable">set</span>) {
                <span class="keyword">if</span> (<span class="variable">set</span> !== <span class="variable">undefined</span>) {
                    <span class="variable">results</span>[<span class="number integer">0</span>].<span class="variable">innerHTML</span> = <span class="variable">set</span>;
                } <span class="keyword">else</span> {
                    <span class="keyword">return</span> <span class="variable">results</span>[<span class="number integer">0</span>].<span class="variable">innerHTML</span>;
                }
            },</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<h2>Form field value extension method</h2>

<p>Gets or sets the value of a form field of the first CSS Selector
element.</p>

<h2>Usage</h2>

<pre><code>tiramisu.get(*SELECTOR*).value([*VALUE*])</code></pre>

<p>where <em>SELECTOR</em> is a valid CSS selector and <em>[VALUE]</em> is an
optional value to set the element's innerHTML value.</p>

<h2>Example #1 (Get the current value of a select list)</h2>

<pre><code>&lt;form id="myForm" action='#' method="GET"&gt;
  &lt;select&gt;
    &lt;option&gt; Apple &lt;/option&gt;
    &lt;option&gt; Strawberry &lt;/option&gt;
    &lt;option&gt; Banana &lt;/option&gt;
  &lt;/select&gt;
&lt;/form&gt;
...
// The default selected value is “Apple”
var current = t.get('myForm select').value();</code></pre>

<h2>Example #2 (Set the current value of a select list)</h2>

<pre><code>&lt;form id="myForm" action='#' method="GET"&gt;
  &lt;select&gt;
    &lt;option&gt; Apple &lt;/option&gt;
    &lt;option&gt; Strawberry &lt;/option&gt;
    &lt;option&gt; Banana &lt;/option&gt;
  &lt;/select&gt;
&lt;/form&gt;
...
t.get('myForm select').value('Strawberry');

// Now the selected value is “Strawberry”
var current = t.get('myForm select').value();</code></pre>

<h2>Example #3 (Get the current values of a series of elements)</h2>

<pre><code>&lt;input type="hidden" name="name_one" value="one" class="i_am_class"&gt;
&lt;input type="hidden" name="name_two" value="two" class="i_am_class"&gt;
&lt;input type="hidden" name="name_three" value="three" class="i_am_class"&gt;
&lt;input type="hidden" name="name_four" value="four" class="i_am_class"&gt;
...
t.get('.i_am_class').value(); // ['one', 'two', 'three', 'four']</code></pre>

<h2></h2>

<ul><li><p><strong>param</strong>: <em>String</em>  [set] An optional string containing the field value to set</p></li><li><p><strong>return</strong>: <em>[String]</em>  An optional string containing the selector's first element field value</p><pre><code>     </code></pre></li></ul>
</td>
<td class="code">
<pre><code><span class="string">'value'</span>: <span class="keyword">function</span>(<span class="variable">set</span>) {
                <span class="keyword">var</span> <span class="variable">value</span> = <span class="keyword">function</span>(<span class="variable">i</span>) {
                        <span class="keyword">if</span> (<span class="variable">t</span>.<span class="variable">detect</span>(<span class="string">'isIE'</span>) || <span class="variable">t</span>.<span class="variable">detect</span>(<span class="string">'isIEolder'</span>)) {
                            <span class="keyword">if</span> (<span class="variable">results</span>[<span class="variable">i</span>].<span class="variable">type</span> == <span class="string">'select-one'</span>) {
                                <span class="keyword">return</span> <span class="variable">results</span>[<span class="variable">i</span>].<span class="variable">options</span>[<span class="variable">results</span>[<span class="variable">i</span>].<span class="variable">selectedIndex</span>].<span class="variable">value</span>;
                            }
                            <span class="keyword">return</span> <span class="variable">results</span>[<span class="variable">i</span>].<span class="variable">value</span>;
                        }
                        <span class="keyword">return</span> <span class="variable">results</span>[<span class="variable">i</span>].<span class="variable">value</span>;
                    };

                <span class="keyword">var</span> <span class="variable">setValue</span> = <span class="keyword">function</span>(<span class="variable">i</span>, <span class="variable">s</span>) {
                        <span class="keyword">if</span> (<span class="variable">t</span>.<span class="variable">detect</span>(<span class="string">'isIE'</span>) || <span class="variable">t</span>.<span class="variable">detect</span>(<span class="string">'isIEolder'</span>)) {
                            <span class="keyword">if</span> (<span class="variable">results</span>[<span class="variable">i</span>].<span class="variable">type</span> == <span class="string">'select-one'</span>) {
                                <span class="variable">results</span>[<span class="variable">i</span>].<span class="variable">options</span>[<span class="variable">results</span>[<span class="variable">i</span>].<span class="variable">selectedIndex</span>].<span class="variable">value</span> = <span class="variable">s</span>;
                            }
                            <span class="variable">results</span>[<span class="variable">i</span>].<span class="variable">value</span> = <span class="variable">s</span>;
                        } <span class="keyword">else</span> {
                            <span class="variable">results</span>[<span class="variable">i</span>].<span class="variable">value</span> = <span class="variable">s</span>;
                        }
                    };

                <span class="keyword">if</span> (<span class="variable">results</span>[<span class="number integer">0</span>] == <span class="variable">undefined</span>) {
                    <span class="keyword">return</span> <span class="string">''</span>;
                }

                <span class="keyword">if</span> (<span class="variable">set</span> !== <span class="variable">undefined</span>) {
                    <span class="variable">setValue</span>(<span class="number integer">0</span>, <span class="variable">set</span>);
                } <span class="keyword">else</span> {
                    <span class="keyword">if</span> (<span class="variable">len_result</span> &<span class="variable">gt</span>; <span class="number integer">1</span>) {
                        <span class="keyword">var</span> <span class="variable">list</span> = [];
                        <span class="keyword">for</span> (<span class="variable">i</span> = <span class="number integer">0</span>; <span class="variable">i</span> &<span class="variable">lt</span>; <span class="variable">len_result</span>; <span class="variable">i</span>++) {
                            <span class="variable">list</span>.<span class="variable">push</span>(<span class="variable">value</span>(<span class="variable">i</span>));
                        }
                        <span class="keyword">return</span> <span class="variable">list</span>;
                    }
                    <span class="keyword">return</span> <span class="variable">value</span>(<span class="number integer">0</span>);
                }
            },</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<h2>?????</h2>

<p>????????????</p>

<h2>Usage</h2>

<pre><code>tiramisu.get(*SELECTOR*).focus()</code></pre>

<p>where <em>SELECTOR</em> is a valid CSS selector ?????</p>

<h2>Example #1 (????)</h2>

<h2></h2>

<ul><li><p><strong>param</strong>: <em>String</em>  ????</p></li><li><p><strong>return</strong>: <em>[String]</em>  ?????</p><pre><code>     </code></pre></li></ul>
</td>
<td class="code">
<pre><code><span class="string">'focus'</span>: <span class="keyword">function</span>() {
                <span class="keyword">if</span> (<span class="variable">results</span>[<span class="number integer">0</span>] == <span class="variable">undefined</span>) {
                    <span class="keyword">return</span> <span class="string">''</span>;
                }
                <span class="keyword">for</span> (<span class="keyword">var</span> <span class="variable">i</span> = <span class="variable">len_result</span>; <span class="variable">i</span>--;) {
                    <span class="variable">results</span>[<span class="variable">i</span>].<span class="variable">focus</span>();
                }
            },</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<h2>Attribute extension method</h2>

<p>Gets or sets the attribute of an element.</p>

<h2>Usage</h2>

<pre><code>tiramisu.get(*SELECTOR*).attr(*ATTRIBUTE*, [*VALUE*])</code></pre>

<p>where <em>SELECTOR</em> is a valid CSS selector,<em>ATTRIBUTE</em> is the name of
the attribute and <em>[VALUE]</em> is an optional value for setting the attribute.</p>

<h2>Example #1 (Get the current src of an image)</h2>

<pre><code>&lt;img src="www.example.com/image_num_one.png" id="id_image" /&gt;
...
var current = t.get('#id_image').attr('src');</code></pre>

<h2>Example #2 (Set the current src of an image)</h2>

<pre><code>&lt;img src="www.example.com/image_num_one.png" id="id_image" /&gt;
...
t.get('#id_image').attr('src', 'www.example.com/image_num_two.png');</code></pre>

<h2></h2>

<ul><li><p><strong>param</strong>: <em>String</em>  [set] An optional string containing the field src to set</p></li><li><p><strong>return</strong>: <em>[String]</em>  An optional string containing the selector's first element field src</p><pre><code>     </code></pre></li></ul>
</td>
<td class="code">
<pre><code><span class="string">'attr'</span>: <span class="keyword">function</span>(<span class="variable">attr</span>, <span class="variable">value</span>) {
                <span class="keyword">if</span> (<span class="variable">value</span> !== <span class="variable">undefined</span>) {
                    <span class="variable">results</span>[<span class="number integer">0</span>][<span class="variable">attr</span>] = <span class="variable">value</span>;
                } <span class="keyword">else</span> {
                    <span class="keyword">return</span> <span class="variable">results</span>[<span class="number integer">0</span>][<span class="variable">attr</span>];
                }
            },</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<h2>Index extension method</h2>

<p>Get the index position of an element.</p>

<h2>Usage</h2>

<pre><code>tiramisu.get(*SELECTOR*).index(*ELEMENT*)</code></pre>

<p>where <em>SELECTOR</em> is a valid CSS selector and <em>ELEMENT</em> is the DOM element
to search.</p>

<p>The function returns -1 if no element is found.</p>

<h2>Example #1 (Get the index of a selector element)</h2>

<pre><code>&lt;p&gt;This&lt;/p&gt;      // element 0
&lt;p&gt;is&lt;/p&gt;        // element 1
&lt;p&gt;Sparta!&lt;/p&gt;   // element 2
...
var el = t.get('p')[2];
var index = t.get('p').index(el); // Contains '2';</code></pre>

<h2></h2>

<ul><li><p><strong>param</strong>: <em>Object</em>  the element to search (that is, a DOM element, not a <em>string</em>)</p></li><li><p><strong>return</strong>: <em>index</em>  the index of the element if found, -1 otherwise</p><pre><code>     </code></pre></li></ul>
</td>
<td class="code">
<pre><code><span class="string">'index'</span>: <span class="keyword">function</span>(<span class="variable">el</span>) {
                <span class="keyword">if</span> (<span class="variable">el</span> !== <span class="variable">undefined</span>) {
                    <span class="keyword">for</span> (<span class="keyword">var</span> <span class="variable">i</span> = <span class="variable">len_result</span>; <span class="variable">i</span> &<span class="variable">gt</span>;= <span class="number integer">0</span>; <span class="variable">i</span>--) {
                        <span class="keyword">if</span> (<span class="variable">results</span>[<span class="variable">i</span>] === <span class="variable">el</span>) <span class="keyword">break</span>;
                    }
                    <span class="keyword">return</span> <span class="variable">i</span>;
                }
            }
        };

        <span class="comment">// Append methods to the result object</span>
        (<span class="keyword">function</span> <span class="variable">append_methods</span>() {
            <span class="keyword">var</span> <span class="variable">key</span>;
            <span class="keyword">for</span> (<span class="variable">key</span> <span class="keyword">in</span> <span class="variable">methods</span>) {
                <span class="variable">results</span>[<span class="variable">key</span>] = <span class="variable">methods</span>[<span class="variable">key</span>];
            }
        })();
        <span class="keyword">return</span> <span class="variable">results</span>;
    };</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<h1>Framework Ajax Module</h1>

<p>This module is mainly used to perform Ajax requests.</p>

<h2>Usage</h2>

<pre><code>tiramisu.ajax(SETTINGS);</code></pre>

<p>where the <em>SETTINGS</em> object can contain the following:</p>

<ul><li><em>async</em> (default is “true”);</li><li><em>content_type</em> (in POST requests default is “application/x-www-form-urlencoded”);</li><li><em>connection</em>;</li><li><em>error</em> (a callback function);</li><li><em>start_load</em> (a callback function);</li><li><em>end_load</em> (a callback function);</li><li><em>loader</em>  (a url loader image);</li><li><em>method</em>  (default is “GET”)</li><li><em>parameter</em>;</li><li><em>success</em> (a callback function);</li><li><em>successHTML</em> (a div id);</li><li><em>url</em> (this is the only <strong>mandatory</strong> field);</li></ul>

<h2>Example #1 (Ajax GET request)</h2>

<pre><code>tiramisu.ajax({
    url : 'http://www.example.com'
});</code></pre>

<h2>Example #2 (Ajax GET request with a success callback)</h2>

<pre><code>tiramisu.ajax({
    url : 'http://www.example.com',
    success : function(data) {
        alert(data);
    }
});</code></pre>

<h2>Example #3 (Ajax GET request loaded into a div with an id)</h2>

<pre><code>tiramisu.ajax({
    url : 'http://www.example.com',
    successHTML : 'responseWrapper'
});</code></pre>

<h2>Example #4 (Ajax POST request displaying a loader)</h2>

<pre><code>tiramisu.ajax({
     url: 'www.example.com',
     method : 'POST',
     loader : 'url_image_loader',
     successHTML : 'responseWrapper'
});</code></pre>

<h2>Example #5 (Ajax POST request with parameters)</h2>

<pre><code>tiramisu.ajax({
    method : 'POST',
    loader : 'url_image_loader',
    parameter: {
        param_1 : 'variable 1',
        param_2 : 'variable 2'
    },
    url : 'http://www.example.com');
});</code></pre>

<h2>Example #6 (Ajax GET request with success and error callbacks)</h2>

<pre><code>tiramisu.ajax({
    url: 'http://www.example.com',
    success: function() {
        console.log('Ok');
    },
    error: function() {
        console.log('Error');
    }
});</code></pre>

<h2>Example #7 (Ajax POST request with successHTML and success callbacks)</h2>

<pre><code>tiramisu.ajax({
   parameter: {
        param_1 : 'variable 1',
        param_2 : 'variable 2'
    },
   success: function(){ ... },
   successHTML: 'responseWrapper',
   url : 'http://www.example.com');</code></pre>

<p>   });</p>

<h2>Error</h2>

<ul><li>#1 : Object Ajax Error!;</li></ul>

<h2></h2>

<ul><li><p><strong>param</strong>: <em>Object</em>  settings An object containing the Ajax call parameters</p></li><li><p><strong>api</strong>: <em>public</em></p><p> </p></li></ul>
</td>
<td class="code">
<pre><code><span class="class">Tiramisu</span>.<span class="variable">prototype</span>.<span class="variable">ajax</span> = <span class="keyword">function</span>(<span class="variable">setting_input</span>) {
        <span class="keyword">var</span> <span class="variable">setting_input</span> = <span class="variable">setting_input</span> || {},
            <span class="variable">setting</span> = {
                <span class="variable">async</span>: <span class="variable">true</span>,
                <span class="variable">content_type</span>: <span class="string">''</span>,
                <span class="variable">connection</span>: <span class="string">''</span>,
                <span class="variable">data_type</span>: <span class="string">''</span>,
                <span class="variable">error</span>: <span class="keyword">function</span>(<span class="variable">res</span>) {
                    <span class="keyword">try</span> {
                        <span class="variable">console</span>.<span class="variable">log</span>(<span class="variable">res</span>)
                    } <span class="keyword">catch</span> (<span class="variable">e</span>) {}
                },
                <span class="variable">start_load</span>: <span class="keyword">function</span>() {},
                <span class="variable">end_load</span>: <span class="keyword">function</span>() {},
                <span class="variable">loader</span>: <span class="string">''</span>,
                <span class="variable">method</span>: <span class="string">'GET'</span>,
                <span class="variable">parameter</span>: <span class="string">''</span>,
                <span class="variable">success</span>: <span class="keyword">function</span>() {},
                <span class="variable">successHTML</span>: <span class="string">''</span>,
                <span class="variable">stop</span>: <span class="string">''</span>,
                <span class="variable">url</span>: <span class="string">''</span>
            },
            <span class="variable">xhr</span> = <span class="keyword">null</span>,
            <span class="variable">parameter</span> = <span class="string">''</span>,
            <span class="comment">// Is very important that parameter dafualt value is ''</span>
            <span class="variable">parameter_count</span> = <span class="number integer">0</span>,
            <span class="variable">url_cache</span> = <span class="string">''</span>;

        <span class="keyword">if</span> (<span class="variable">window</span>.<span class="class">XMLHttpRequest</span>) {
            <span class="variable">xhr</span> = <span class="keyword">new</span> <span class="class">XMLHttpRequest</span>();
        } <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">window</span>.<span class="class">ActiveXObject</span>) {
            <span class="variable">xhr</span> = <span class="keyword">new</span> <span class="class">ActiveXObject</span>(&<span class="variable">quot</span>;<span class="class">Microsoft</span>.<span class="class">XMLHTTP</span>&<span class="variable">quot</span>;);
        } <span class="keyword">else</span> {
            <span class="variable">setting</span>.<span class="variable">error</span>(<span class="string">'e_ajax#1'</span>);
        }

        <span class="variable">extend</span>(<span class="variable">setting</span>, <span class="variable">setting_input</span>);

        <span class="comment">// object &quot;setting.parameter&quot; I create a string with the parameters </span>
        <span class="comment">// to be passed in request</span>
        <span class="keyword">if</span> (<span class="variable">setting</span>.<span class="variable">parameter</span> != <span class="string">''</span>) {
            <span class="keyword">for</span> (<span class="variable">attrname</span> <span class="keyword">in</span> <span class="variable">setting</span>.<span class="variable">parameter</span>) {
                <span class="variable">parameter</span> += <span class="variable">attrname</span> + <span class="string">'='</span> + <span class="variable">setting</span>.<span class="variable">parameter</span>[<span class="variable">attrname</span>] + <span class="string">'&amp;'</span>;
            }
            <span class="variable">parameter</span> = <span class="variable">parameter</span>.<span class="variable">substring</span>(<span class="number integer">0</span>, <span class="variable">parameter</span>.<span class="variable">length</span> - <span class="number integer">1</span>);
            <span class="keyword">if</span> (!<span class="variable">setting</span>.<span class="variable">content_type</span>) {
                <span class="variable">setting</span>.<span class="variable">content_type</span> = <span class="string">'application/x-www-form-urlencoded'</span>;
            }
            <span class="variable">setting</span>.<span class="variable">method</span> = <span class="string">'POST'</span>;
        } <span class="keyword">else</span> {
            <span class="variable">parameter</span> = <span class="keyword">null</span>;
        }

        <span class="keyword">if</span> (<span class="variable">t</span>.<span class="variable">detect</span>(<span class="string">'isIE'</span>)) {
            <span class="comment">// Easy Solution for Internet Explorer</span>
            <span class="variable">url_cache</span> = <span class="string">'?'</span> + ((<span class="string">''</span> + <span class="class">Math</span>.<span class="variable">random</span>()).<span class="variable">replace</span>(<span class="regexp">/\D/g</span>, <span class="string">''</span>));
        }

        <span class="comment">// The open() method!</span>
        <span class="comment">// When the open(method, url, async, user, password) method is invoked, the </span>
        <span class="comment">// user agent must run these steps (unless otherwise indicated):</span>
        <span class="comment">// 1) If the XMLHttpRequest object has an associated XMLHttpRequest Document;</span>
        <span class="comment">// 2) If method is a case-insensitive match for CONNECT, DELETE, GET, HEAD, </span>
        <span class="comment">//    OPTIONS, POST, PUT, TRACE;</span>
        <span class="comment">// 3) Let url be a URL;</span>
        <span class="comment">// 4) Let async be the value of the async argument or true if it was omitted;</span>
        <span class="comment">// 5) Abort the send() algorithm;</span>
        <span class="comment">// 6) If there are any tasks from the object's XMLHttpRequest task source in </span>
        <span class="comment">//    one of the task queues, then remove those tasks.</span>
        <span class="comment">// 7) Set variables associated with the object as follows:</span>
        <span class="comment">//		- Set the send() flag to false;</span>
        <span class="comment">//		- Set response entity body to null;</span>
        <span class="comment">//		- Empty the list of author request headers;</span>
        <span class="comment">//		- Set method, url, temp user, temp password, value of async.</span>
        <span class="comment">// 8) Switch the the state to OPENED;</span>
        <span class="comment">// 9) Dispatch a readystatechange event.</span>
        <span class="comment">//</span>
        <span class="variable">xhr</span>.<span class="variable">open</span>(<span class="variable">setting</span>.<span class="variable">method</span>, <span class="variable">setting</span>.<span class="variable">url</span> + <span class="variable">url_cache</span>, <span class="variable">setting</span>.<span class="variable">async</span>);

        <span class="comment">// The setRequestHeader() method!</span>
        <span class="comment">// When the setRequestHeader(header, value) method is invoked, </span>
        <span class="comment">// the user agent must run these steps:</span>
        <span class="comment">// 1) If the state is not OPENED raise an INVALID_STATE_ERR exception </span>
        <span class="comment">//    and terminate these steps;</span>
        <span class="comment">// 2) If the send() flag is true raise an INVALID_STATE_ERR exception </span>
        <span class="comment">//    and terminate these steps;</span>
        <span class="comment">// 3) Terminate these steps if header is a case-insensitive match for </span>
        <span class="comment">//    one of the following headers: </span>
        <span class="comment">//    Accept-Charset, Accept-Encoding, Connection, Content-Length, Cookie,</span>
        <span class="comment">//	  Cookie2, Content-Transfer-Encoding, Date, Expect, Host, Keep-Alive,</span>
        <span class="comment">//    Referer, TE, Trailer, Transfer-Encoding, Upgrade, User-Agent, Via.</span>
        <span class="comment">//</span>
        <span class="keyword">if</span> (<span class="variable">setting</span>.<span class="variable">content_type</span>) {
            <span class="variable">xhr</span>.<span class="variable">setRequestHeader</span>(<span class="string">'Content-type'</span>, <span class="variable">setting</span>.<span class="variable">content_type</span>);
        }

        <span class="keyword">if</span> (<span class="variable">setting</span>.<span class="variable">connection</span>) {
            <span class="variable">xhr</span>.<span class="variable">setRequestHeader</span>(<span class="string">'Connection'</span>, <span class="variable">setting</span>.<span class="variable">connection</span>);
        }

        <span class="keyword">if</span> (<span class="variable">setting</span>.<span class="variable">data_type</span>) {
            <span class="variable">xhr</span>.<span class="variable">setRequestHeader</span>(<span class="string">'dataType'</span>, <span class="variable">setting</span>.<span class="variable">data_type</span>);
        }

        <span class="keyword">if</span> (<span class="variable">setting</span>.<span class="variable">loader</span>) {
            <span class="keyword">var</span> <span class="variable">img</span> = <span class="string">'&lt;img src=&quot;'</span> + <span class="variable">setting</span>.<span class="variable">loader</span> + <span class="string">'&quot; alt=&quot;&quot; /&gt;'</span>;
            <span class="variable">t</span>.<span class="variable">d</span>.<span class="variable">getElementById</span>(<span class="variable">setting</span>.<span class="variable">successHTML</span>).<span class="variable">innerHTML</span> = <span class="variable">img</span>;
        }

        <span class="variable">setting</span>.<span class="variable">start_load</span>();

        <span class="keyword">if</span> (<span class="variable">setting</span>.<span class="variable">stop</span>) {
            <span class="variable">t</span>.<span class="variable">task</span>(<span class="variable">setting</span>.<span class="variable">stop</span>, <span class="keyword">function</span>() {
                <span class="variable">xhr</span>.<span class="variable">abort</span>();
            })
        }

        <span class="variable">xhr</span>.<span class="variable">onreadystatechange</span> = <span class="keyword">function</span>() {
            <span class="keyword">if</span> (<span class="variable">xhr</span>.<span class="variable">readyState</span> == <span class="number integer">4</span> &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="variable">xhr</span>.<span class="variable">status</span> == <span class="number integer">200</span>) {
                <span class="comment">// success!</span>
                <span class="keyword">if</span> (<span class="variable">setting</span>.<span class="variable">successHTML</span>) {
                    <span class="keyword">if</span> (<span class="keyword">typeof</span>(<span class="variable">setting</span>.<span class="variable">successHTML</span>) === <span class="string">'string'</span>) {
                        <span class="variable">t</span>.<span class="variable">d</span>.<span class="variable">getElementById</span>(<span class="variable">setting</span>.<span class="variable">successHTML</span>).<span class="variable">innerHTML</span> = <span class="variable">xhr</span>.<span class="variable">responseText</span>;
                    } <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span>(<span class="variable">setting</span>.<span class="variable">successHTML</span>) === <span class="string">'object'</span>) {
                        <span class="keyword">if</span> (<span class="keyword">typeof</span>(<span class="variable">setting</span>.<span class="variable">successHTML</span>.<span class="variable">html</span>) === <span class="string">'function'</span>) {
                            <span class="variable">setting</span>.<span class="variable">successHTML</span>.<span class="variable">html</span>(<span class="variable">xhr</span>.<span class="variable">responseText</span>);
                        } <span class="keyword">else</span> {
                            <span class="variable">setting</span>.<span class="variable">successHTML</span>.<span class="variable">innerHTML</span> = <span class="variable">xhr</span>.<span class="variable">responseText</span>;
                        }
                    }
                }
                <span class="variable">setting</span>.<span class="variable">end_load</span>();
                <span class="variable">setting</span>.<span class="variable">success</span>(<span class="variable">xhr</span>.<span class="variable">responseText</span>);
            } <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">xhr</span>.<span class="variable">readyState</span> == <span class="number integer">4</span> &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="variable">xhr</span>.<span class="variable">status</span> == <span class="number integer">400</span>) {
                <span class="variable">setting</span>.<span class="variable">end_load</span>();
                <span class="comment">// 400 Bad Request</span>
                <span class="variable">setting</span>.<span class="variable">error</span>(<span class="string">'400 Bad Request'</span>);
            } <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">xhr</span>.<span class="variable">readyState</span> == <span class="number integer">4</span> &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="variable">xhr</span>.<span class="variable">status</span> != <span class="number integer">200</span>) {
                <span class="variable">setting</span>.<span class="variable">end_load</span>();
                <span class="comment">// fetched the wrong page or network error...</span>
                <span class="variable">setting</span>.<span class="variable">error</span>(<span class="string">'Fetched the wrong page or network error'</span>);
            }
        };

        <span class="comment">// The send() method!</span>
        <span class="comment">// When the send(data) method is invoked, the user agent must run the following steps </span>
        <span class="comment">// (unless otherwise noted). This algorithm gets aborted when the open() or abort() method </span>
        <span class="comment">// is invoked. When the send() algorithm is aborted the user agent must terminate the </span>
        <span class="comment">// algorithm after finishing the step it is on.</span>
        <span class="comment">// 1) If the state is not OPENED raise an INVALID_STATE_ERR exception and terminate </span>
        <span class="comment">//    these steps.</span>
        <span class="comment">// 2) If the send() flag is true raise an INVALID_STATE_ERR exception and terminate these steps.</span>
        <span class="comment">// 3) If the request method is a case-sensitive match for GET or HEAD act as if data is null.</span>
        <span class="comment">//    If the data argument has been omitted or is null, do not include a request entity body </span>
        <span class="comment">//    and go to the next step.</span>
        <span class="comment">//    If a Content-Type header is set using setRequestHeader() whose value is a valid MIME type </span>
        <span class="comment">//    and has a charset parameter whose value is not a case-insensitive match for encoding, </span>
        <span class="comment">//    and encoding is not null, set all the charset parameters of the Content-Type header to encoding.</span>
        <span class="comment">//    If no Content-Type header has been set using setRequestHeader() and mime type is not null set a </span>
        <span class="comment">//    Content-Type request header with as value mime type.</span>
        <span class="comment">// 4) If the asynchronous flag is false release the storage mutex.</span>
        <span class="comment">// 5) Set the error flag to false.</span>
        <span class="comment">//</span>
        <span class="variable">xhr</span>.<span class="variable">send</span>(<span class="variable">parameter</span>);
        <span class="keyword">return</span> <span class="this">this</span>;
    };</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<h1>Task Engine Module</h1>

<p>This module is used to perform a function at a particular amount of time
or perform the same function several times in that time frame.</p>

<h2>Usage</h2>

<pre><code>tiramisu.task(delay, [interval], callback);</code></pre>

<p>where “interval” is an optional argument</p>

<h2>Example #1 (The callback is executed after 2000 ms)</h2>

<pre><code>tiramisu.task(2000, callback)</code></pre>

<h2>Example #2 (The callback is executed every 100 ms in a period of 2000ms)</h2>

<pre><code>tiramisu.task(2000, 100, callback)</code></pre>

<h2>Example #3 (The callback is executed every 500 ms in loop.)</h2>

<pre><code>tiramisu.task('loop', 500, callback)</code></pre>

<h2></h2>

<ul><li><p><strong>param</strong>: <em>integer</em>  delay The total task delay(ms)</p></li><li><p><strong>param</strong>: <em>integer</em>  [interval] The interval of the repetitions(ms)</p></li><li><p><strong>param</strong>: <em>Function</em>  cb The callback function</p><p> </p></li></ul>
</td>
<td class="code">
<pre><code><span class="class">Tiramisu</span>.<span class="variable">prototype</span>[<span class="string">'task'</span>] = <span class="keyword">function</span>(<span class="variable">delay</span>, <span class="variable">cb</span>) {
        <span class="keyword">var</span> <span class="variable">interval</span>, <span class="variable">requestAnimFrame</span> = <span class="variable">t</span>.<span class="variable">requestAnimFrame</span>;

        <span class="keyword">if</span> (<span class="variable">arguments</span>.<span class="variable">length</span> &<span class="variable">gt</span>; <span class="number integer">2</span>) {
            <span class="variable">interval</span> = <span class="variable">arguments</span>[<span class="number integer">1</span>];
            <span class="variable">cb</span> = <span class="variable">arguments</span>[<span class="number integer">2</span>];
        }

        <span class="keyword">var</span> <span class="variable">start</span> = +<span class="keyword">new</span> <span class="class">Date</span>(),
            <span class="variable">pass</span> = <span class="variable">interval</span>;

        <span class="keyword">function</span> <span class="variable">animate</span>() {
            <span class="keyword">var</span> <span class="variable">progress</span> = +<span class="keyword">new</span> <span class="class">Date</span>() - <span class="variable">start</span>;

            <span class="keyword">if</span> (<span class="variable">interval</span> !== <span class="variable">undefined</span>) {
                <span class="keyword">if</span> (<span class="variable">progress</span> &<span class="variable">gt</span>; <span class="variable">pass</span>) {
                    <span class="variable">pass</span> += <span class="variable">interval</span>;
                    <span class="variable">cb</span>();
                }
            }

            <span class="comment">// The recursion continues only in two cases:</span>
            <span class="comment">// - The elapsed time is less than the total time;</span>
            <span class="comment">// - The total time is infinite (so a loop) but there </span>
            <span class="comment">//   is an interval of time between repetitions of the callback.</span>
            <span class="keyword">if</span> (<span class="variable">progress</span> &<span class="variable">lt</span>; <span class="variable">delay</span> || (<span class="variable">delay</span> == <span class="string">'loop'</span> &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="variable">interval</span> !== <span class="variable">undefined</span>)) {
                <span class="variable">requestAnimFrame</span>(<span class="variable">animate</span>);
            } <span class="keyword">else</span> {
                <span class="keyword">if</span> (<span class="variable">interval</span> === <span class="variable">undefined</span>) {
                    <span class="variable">cb</span>();
                }
            }
        }
        <span class="variable">animate</span>();
    };
})(<span class="variable">window</span>);
</code></pre>
</td>
</tr>	</body>
</html></tbody></table>