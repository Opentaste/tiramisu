<html>
	<head>
		<title>Tiramisu</title>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
		<style>body {
    margin: 0;
    padding: 0;
    font: 14px/1.5 'Palatino Linotype', 'Book Antiqua', Palatino, FreeSerif, serif;
    color: #252519;
}
a {
    color: #252519;
}
a:hover {
    text-decoration: underline;
    color: #19469D;
}
p {
    margin: 12px 0;
}
h1, h2, h3 {
    margin: 0;
    padding: 0;
}
table#source {
    width: 100%;
    border-collapse: collapse;
}
table#source td:first-child {
    padding: 30px 40px 30px 40px;
    vertical-align: top;
}
table#source td:first-child,
table#source td:first-child pre {
    width: 450px;
}
table#source td:last-child {
    padding: 30px 0 30px 40px;
    border-left: 1px solid #E5E5EE;
    background: #F5F5FF;
}
table#source tr {
    border-bottom: 1px solid #E5E5EE;
}
table#source tr.filename {
    padding-top: 40px;
    border-top: 1px solid #E5E5EE;
}
table#source tr.filename td:first-child {
    text-transform: capitalize;
}
table#source tr.filename td:last-child {
    font-size: 12px;
}
table#source tr.filename h2 {
    margin: 0;
    padding: 0;
    cursor: pointer;
}
table#source tr.code h1,
table#source tr.code h2,
table#source tr.code h3 {
    margin-top: 30px;
    font-family: "Lucida Grande", "Helvetica Nueue", Arial, sans-serif;
    font-size: 18px;
}
table#source tr.code h2 {
    font-size: 16px;
}
table#source tr.code h3 {
    font-size: 14px;
}
table#source tr.code ul {
    margin: 15px 0 15px 35px;
    padding: 0;
}
table#source tr.code ul li {
    margin: 0;
    padding: 1px 0;
}
table#source tr.code ul li p {
    margin: 0;
    padding: 0;
}
table#source tr.code td:first-child pre {
    padding: 20px;
}
#ribbon {
    position: fixed;
    top: 0;
    right: 0;
}
code .string { color: #219161; }
code .regexp { color: #219161; }
code .keyword { color: #954121; }
code .number { color: #19469D; }
code .comment { color: #bbb; }
code .this { color: #19469D; }</style>
		<script>
			$(function(){
				$('tr.code').hide();
				$('tr.filename').toggle(function(){
					$(this).nextUntil('.filename').fadeIn();
				}, function(){
					$(this).nextUntil('.filename').fadeOut();
				});
			});
		</script>
	</head>
	<body>
<table id="source"><tbody><tr><td><h1>Tiramisu</h1><p>Tiramisu is a tiny, modular and fast JavaScript microframework 
which takes inspiration from the famous <a href="http://jquery.com/">jQuery</a> syntax:</p>

<pre><code>tiramisu.get('h1 #unique').each(function() {
        alert(h1.innerHTML);
});</code></pre>

<p>Here are some highlights:</p>

<ul><li>Modular <em>philosophy</em>;</li><li><em>Very small</em> size (6,8Kb minified);</li><li><em>Chainable</em> methods;</li><li>Task management (a.k.a. Callbacks scheduling);</li><li>Supports <em>each</em>, <em>map</em> and other <em>functional programming</em> utilities.</li></ul></td><td></td></tr><tr class="filename"><td><h2 id="src/tiramisu.js"><a href="#">tiramisu</a></h2></td><td>src/tiramisu.js</td></tr><tr class="code">
<td class="docs">
<p>The Framework's costructor exposes externally: </p>

<ul><li>A version number;</li><li>A document object reference;</li><li><em>requestAnimFrame</em> (used for handling tasks).
 </li></ul>
</td>
<td class="code">
<pre><code><span class="keyword">function</span> <span class="class">Tiramisu</span>() {
		<span class="this">this</span>.<span class="variable">version</span> = <span class="string">'0.0.5'</span>;
		<span class="this">this</span>.<span class="variable">d</span> = <span class="variable">document</span>;
		<span class="this">this</span>.<span class="variable">requestAnimFrame</span> = (<span class="keyword">function</span>() {
			<span class="keyword">return</span> <span class="variable">window</span>.<span class="variable">requestAnimationFrame</span> 
            || <span class="variable">window</span>.<span class="variable">webkitRequestAnimationFrame</span> 
            || <span class="variable">window</span>.<span class="variable">mozRequestAnimationFrame</span> 
            || <span class="variable">window</span>.<span class="variable">oRequestAnimationFrame</span> 
            || <span class="variable">window</span>.<span class="variable">msRequestAnimationFrame</span> 
            || <span class="keyword">function</span>(<span class="variable">callback</span>, <span class="variable">element</span>) {
                   <span class="variable">window</span>.<span class="variable">setTimeout</span>(<span class="variable">callback</span>, <span class="number integer">1000</span> / <span class="number integer">60</span>);
			};
		})();
	}

	<span class="comment">// Exposing the framework</span>
	<span class="variable">window</span>.<span class="variable">tiramisu</span> = <span class="keyword">new</span> <span class="class">Tiramisu</span>();

	<span class="comment">// Extending object1 with object2's methods</span>
	<span class="keyword">function</span> <span class="variable">extend</span>(<span class="variable">first</span>, <span class="variable">second</span>) {
		<span class="keyword">for</span> (<span class="keyword">var</span> <span class="variable">prop</span> <span class="keyword">in</span> <span class="variable">second</span>) {
			<span class="variable">first</span>[<span class="variable">prop</span>] = <span class="variable">second</span>[<span class="variable">prop</span>];
		}
	}</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<h1>Framework Detection Module</h1>

<p>This module is mainly used to perform several <em>browser-detection tests</em>:</p>

<ul><li>browser</li><li>isIE, isFirefox, isChrome</li><li>querySelectorAll</li><li>opacity, color</li></ul>

<p>Compatibility for not support CSS:</p>

<ul><li>position:fixed - iOS Safari / Opera Mini</li><li>CSS3 Opacity - I8 older using the "filter" property</li><li>CSS3 Colors - I8 older using rgb rather than rgba</li></ul>

<h2>Example (Detect browser)</h2>

<p>Here's an example on how to <em>detect</em> the current browser:</p>

<pre><code>if (tiramisu.detect('browser') === 'IE9')) {
    console.log('IE');
}</code></pre>

<p>A shortcut to perform this check is:</p>

<pre><code>if (tiramisu.detect('isIE')) {
    console.log('IE');
}</code></pre>

<p>The main difference between the first and the second example is that
<em>isIE</em> and, in general, <em>is(X)</em> methods doesn't check the browser for
a specific version.</p>

<p>If you need to perform a check for a specific version you'll need to rely on <em>detect('browser')</em>;
the possible return values are:</p>

<ul><li><em>safarichrome</em>;</li><li><em>firefox3</em>;</li><li><em>firefox4</em>;</li><li><em>Opera10.4</em>;</li><li><em>Opera10.5+</em>;</li><li><em>IE_older</em> (For IE &lt;= 6).</li><li><em>IE8</em>;</li><li><em>IE9+</em>;</li></ul>

<h2></h2>

<ul><li><p><strong>param</strong>: <em>String</em>  key The test to perform (see the var tests below)</p></li><li><p><strong>returns</strong>: <em>Boolean</em>  The test result</p></li><li><p><strong>api</strong>: <em>public</em></p><p> </p></li></ul>
</td>
<td class="code">
<pre><code><span class="class">Tiramisu</span>.<span class="variable">prototype</span>.<span class="variable">detect</span> = <span class="keyword">function</span>(<span class="variable">key</span>) {
		<span class="keyword">var</span> <span class="variable">nav_agent</span> = <span class="variable">navigator</span>.<span class="variable">userAgent</span>,
		<span class="variable">nav_name</span> = <span class="variable">navigator</span>.<span class="variable">appName</span>,
		<span class="variable">firefox</span> = <span class="variable">nav_agent</span>.<span class="variable">substring</span>(<span class="variable">nav_agent</span>.<span class="variable">indexOf</span>(<span class="string">'Firefox'</span>)),
		<span class="variable">firefox_version</span> = <span class="variable">firefox</span>.<span class="variable">split</span>(<span class="string">'/'</span>)[<span class="number integer">1</span>].<span class="variable">split</span>(<span class="string">'.'</span>)[<span class="number integer">0</span>],
		<span class="variable">opera</span> = <span class="variable">nav_agent</span>.<span class="variable">substring</span>(<span class="variable">nav_agent</span>.<span class="variable">indexOf</span>(<span class="string">'Version'</span>)).<span class="variable">split</span>(&<span class="variable">quot</span>;/&<span class="variable">quot</span>;)[<span class="number integer">1</span>];

		<span class="comment">// Turns off querySelectorAll detection</span>
		<span class="keyword">var</span> <span class="class">USE_QSA</span> = <span class="variable">false</span>;

		<span class="comment">// Netscape includes Firefox, Safari or Chrome</span>
		<span class="keyword">var</span> <span class="variable">tests</span> = {

			<span class="string">'browser'</span>: <span class="keyword">function</span>() {
				<span class="keyword">if</span> (<span class="variable">nav_name</span> === <span class="string">'Netscape'</span>) {
					<span class="keyword">if</span> (<span class="variable">firefox</span>.<span class="variable">split</span>(<span class="string">'/'</span>)[<span class="number integer">0</span>] !== <span class="string">'Firefox'</span>) { <span class="comment">// Case 1 - Safari or Chrome</span>
						<span class="keyword">return</span> &<span class="variable">quot</span>;<span class="variable">safarichrome</span>&<span class="variable">quot</span>;
					} <span class="keyword">else</span> {
						<span class="keyword">if</span> (<span class="variable">firefox_version</span> === <span class="string">'4'</span>) { <span class="comment">// Case 2 - Firefox 4</span>
							<span class="keyword">return</span> <span class="string">'firefox4'</span>
						}
						<span class="keyword">return</span> <span class="string">'firefox3'</span>
					}
				} <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">nav_name</span> == <span class="string">'Opera'</span>) {
					<span class="keyword">if</span> (<span class="variable">opera</span>.<span class="variable">split</span>(<span class="string">'.'</span>)[<span class="number integer">1</span>] &<span class="variable">gt</span>; <span class="number integer">49</span>) { <span class="comment">// Case 4 - Opera 10.5+</span>
						<span class="keyword">return</span> <span class="string">'Opera10.5+'</span>
					}
					<span class="keyword">return</span> <span class="string">'Opera10.4'</span>;
				} <span class="keyword">else</span> <span class="keyword">if</span> (<span class="regexp">/MSIE (\d+\.\d+);/</span>.<span class="variable">test</span>(<span class="variable">nav_agent</span>)) { <span class="comment">//test for MSIE x.x;</span>
					<span class="keyword">var</span> <span class="variable">ie</span> = <span class="keyword">new</span> <span class="class">Number</span>(<span class="class">RegExp</span>.$<span class="number integer">1</span>) <span class="comment">// capture x.x portion and store as a number</span>
					<span class="keyword">if</span> (<span class="variable">ie</span> &<span class="variable">gt</span>; <span class="number integer">8</span>) {
						<span class="keyword">return</span> <span class="string">'IE9+'</span>;
					} <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">ie</span> === <span class="number integer">8</span>) {
						<span class="keyword">return</span> <span class="string">'IE8'</span>;
					}
					<span class="keyword">return</span> <span class="string">'IE_older'</span>;
				} <span class="keyword">else</span> { <span class="comment">// Case 6 - IE or other</span>
					<span class="keyword">return</span> <span class="string">'IE'</span>;
				}
			},

			<span class="string">'isIE'</span>: <span class="keyword">function</span>() {
				<span class="keyword">return</span> <span class="this">this</span>.<span class="variable">browser</span>() === <span class="string">'IE9+'</span> || <span class="this">this</span>.<span class="variable">browser</span>() === <span class="string">'IE8'</span> || <span class="this">this</span>.<span class="variable">browser</span>() === <span class="string">'IE_older'</span>;
			},

			<span class="string">'isIEolder'</span>: <span class="keyword">function</span>() {
				<span class="keyword">return</span> <span class="this">this</span>.<span class="variable">browser</span>() === <span class="string">'IE8'</span> || <span class="this">this</span>.<span class="variable">browser</span>() === <span class="string">'IE_older'</span>;
			},

			<span class="string">'isFirefox'</span>: <span class="keyword">function</span>() {
				<span class="keyword">return</span> <span class="this">this</span>.<span class="variable">browser</span>() === &<span class="variable">quot</span>;<span class="variable">firefox3</span>&<span class="variable">quot</span>; || <span class="this">this</span>.<span class="variable">browser</span>() === &<span class="variable">quot</span>;<span class="variable">firefox4</span>&<span class="variable">quot</span>;
			},

			<span class="string">'isChrome'</span>: <span class="keyword">function</span>() {
				<span class="keyword">return</span> <span class="this">this</span>.<span class="variable">browser</span>() === <span class="string">'safarichrome'</span>
			},

			<span class="string">'querySelectorAll'</span>: <span class="keyword">function</span>() {
				<span class="keyword">return</span> (<span class="class">USE_QSA</span> &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="keyword">typeof</span> <span class="this">this</span>.<span class="variable">d</span>.<span class="variable">querySelectorAll</span> !== <span class="string">'undefined'</span>)
			},

			<span class="string">'opacity'</span>: <span class="keyword">function</span>() {
				<span class="keyword">if</span> (<span class="this">this</span>.<span class="variable">isIEolder</span>()) {
					<span class="keyword">return</span> <span class="variable">false</span>;
				}
				<span class="keyword">return</span> <span class="variable">true</span>;
			},

			<span class="string">'color'</span>: <span class="keyword">function</span>() {
				<span class="keyword">if</span> (<span class="this">this</span>.<span class="variable">isIEolder</span>()) {
					<span class="keyword">return</span> <span class="variable">false</span>;
				}
				<span class="keyword">return</span> <span class="variable">true</span>;
			}
		};
		<span class="keyword">return</span> <span class="variable">tests</span>[<span class="variable">key</span>]();
	};</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<h1>Framework Selector Module</h1>

<p><strong>TODO:</strong></p>

<ul><li>Write docs</li></ul>

<h2></h2>

<ul><li><p><strong>param</strong>: <em>String</em>  selector A CSS Selector</p></li><li><p><strong>returns</strong>: <em>Object</em>  The node list</p></li><li><p><strong>api</strong>: <em>public</em></p><p> </p></li></ul>
</td>
<td class="code">
<pre><code><span class="class">Tiramisu</span>.<span class="variable">prototype</span>.<span class="variable">get</span> = <span class="variable">window</span>.$<span class="variable">t</span> = <span class="keyword">function</span>(<span class="variable">selector</span>) {
		<span class="keyword">if</span> (<span class="variable">tiramisu</span>.<span class="variable">detect</span>(<span class="string">'querySelectorAll'</span>)) <span class="keyword">return</span> <span class="this">this</span>.<span class="variable">d</span>.<span class="variable">querySelectorAll</span>(<span class="variable">selector</span>);

		<span class="keyword">var</span> <span class="variable">macros</span> = {
			<span class="string">'nl'</span>: <span class="string">'\n|\r\n|\r|\f'</span>,
			<span class="string">'nonascii'</span>: <span class="string">'[^\0-\177]'</span>,
			<span class="string">'unicode'</span>: <span class="string">'\\[0-9A-Fa-f]{1,6}(\r\n|[\s\n\r\t\f])?'</span>,
			<span class="string">'escape'</span>: <span class="string">'#{unicode}|\\[^\n\r\f0-9A-Fa-f]'</span>,
			<span class="string">'nmchar'</span>: <span class="string">'[_A-Za-z0-9-]|#{nonascii}|#{escape}'</span>,
			<span class="string">'nmstart'</span>: <span class="string">'[_A-Za-z]|#{nonascii}|#{escape}'</span>,
			<span class="string">'ident'</span>: <span class="string">'[-@]?(#{nmstart})(#{nmchar})*'</span>,
			<span class="string">'name'</span>: <span class="string">'(#{nmchar})+'</span>
		};

		<span class="keyword">var</span> <span class="variable">rules</span> = {
			<span class="string">'id and name'</span>: <span class="string">'(#{ident}##{ident})'</span>,
			<span class="string">'id'</span>: <span class="string">'(##{ident})'</span>,
			<span class="string">'class'</span>: <span class="string">'(\\.#{ident})'</span>,
			<span class="string">'name and class'</span>: <span class="string">'(#{ident}\\.#{ident})'</span>,
			<span class="string">'element'</span>: <span class="string">'(#{ident})'</span>,
			<span class="string">'pseudo class'</span>: <span class="string">'(:#{ident})'</span>
		};

		<span class="comment">// Normalize the selector</span>
		<span class="keyword">function</span> <span class="variable">normalize</span>(<span class="variable">text</span>) {
			<span class="keyword">return</span> <span class="variable">text</span>.<span class="variable">replace</span>(<span class="regexp">/^\s+|\s+$/g</span>, <span class="string">''</span>).<span class="variable">replace</span>(<span class="regexp">/[ \t\r\n\f]+/g</span>, <span class="string">' '</span>);
		}

		<span class="comment">// Scan macros and rules to build a big regex</span>
		<span class="keyword">var</span> <span class="variable">scanner</span> = <span class="keyword">function</span>() {
			<span class="keyword">function</span> <span class="variable">replacePattern</span>(<span class="variable">pattern</span>, <span class="variable">patterns</span>) {
				<span class="keyword">var</span> <span class="variable">matched</span> = <span class="variable">true</span>,
				<span class="variable">match</span>;
				<span class="keyword">while</span> (<span class="variable">matched</span>) {
					<span class="variable">match</span> = <span class="variable">pattern</span>.<span class="variable">match</span>(<span class="regexp">/#\{([^}]+)\}/</span>);
					<span class="keyword">if</span> (<span class="variable">match</span> &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="variable">match</span>[<span class="number integer">1</span>]) {
						<span class="variable">pattern</span> = <span class="variable">pattern</span>.<span class="variable">replace</span>(<span class="keyword">new</span> <span class="class">RegExp</span>(<span class="string">'#\{'</span> + <span class="variable">match</span>[<span class="number integer">1</span>] + <span class="string">'\}'</span>, <span class="string">'g'</span>), <span class="variable">patterns</span>[<span class="variable">match</span>[<span class="number integer">1</span>]]);
						<span class="variable">matched</span> = <span class="variable">true</span>;
					} <span class="keyword">else</span> {
						<span class="variable">matched</span> = <span class="variable">false</span>;
					}
				}
				<span class="keyword">return</span> <span class="variable">pattern</span>;
			}

			<span class="keyword">function</span> <span class="variable">escapePattern</span>(<span class="variable">text</span>) {
				<span class="keyword">return</span> <span class="variable">text</span>.<span class="variable">replace</span>(<span class="regexp">/\/</span><span class="regexp">/g, '/</span>/');
			}

			<span class="keyword">function</span> <span class="variable">convertPatterns</span>() {
				<span class="keyword">var</span> <span class="variable">key</span>, <span class="variable">pattern</span>, <span class="variable">results</span> = {},
				<span class="variable">patterns</span>, <span class="variable">source</span>;

				<span class="keyword">if</span> (<span class="variable">arguments</span>.<span class="variable">length</span> === <span class="number integer">2</span>) {
					<span class="variable">source</span> = <span class="variable">arguments</span>[<span class="number integer">0</span>];
					<span class="variable">patterns</span> = <span class="variable">arguments</span>[<span class="number integer">1</span>]
				} <span class="keyword">else</span> {
					<span class="variable">source</span> = <span class="variable">arguments</span>[<span class="number integer">0</span>];
					<span class="variable">patterns</span> = <span class="variable">arguments</span>[<span class="number integer">0</span>];
				}

				<span class="keyword">for</span> (<span class="variable">key</span> <span class="keyword">in</span> <span class="variable">patterns</span>) {
					<span class="variable">pattern</span> = <span class="variable">escapePattern</span>(<span class="variable">replacePattern</span>(<span class="variable">patterns</span>[<span class="variable">key</span>], <span class="variable">source</span>));
					<span class="variable">results</span>[<span class="variable">key</span>] = <span class="variable">pattern</span>;
				}
				<span class="keyword">return</span> <span class="variable">results</span>;
			}

			<span class="keyword">function</span> <span class="variable">joinPatterns</span>(<span class="variable">regexps</span>) {
				<span class="keyword">var</span> <span class="variable">results</span> = [],
				<span class="variable">key</span>;

				<span class="keyword">for</span> (<span class="variable">key</span> <span class="keyword">in</span> <span class="variable">regexps</span>) {
					<span class="variable">results</span>.<span class="variable">push</span>(<span class="variable">regexps</span>[<span class="variable">key</span>]);
				}

				<span class="keyword">return</span> <span class="keyword">new</span> <span class="class">RegExp</span>(<span class="variable">results</span>.<span class="variable">join</span>(<span class="string">'|'</span>), <span class="string">'g'</span>);
			}

			<span class="keyword">return</span> <span class="variable">joinPatterns</span>(<span class="variable">convertPatterns</span>(<span class="variable">convertPatterns</span>(<span class="variable">macros</span>), <span class="variable">rules</span>));
		};

		<span class="keyword">var</span> <span class="variable">filter</span> = {
			<span class="string">'byAttr'</span>: <span class="keyword">function</span>(<span class="variable">elements</span>, <span class="variable">attribute</span>, <span class="variable">value</span>) {
				<span class="keyword">var</span> <span class="variable">key</span>, <span class="variable">results</span> = [];
				<span class="keyword">for</span> (<span class="variable">key</span> <span class="keyword">in</span> <span class="variable">elements</span>) {
					<span class="keyword">if</span> (<span class="variable">elements</span>[<span class="variable">key</span>] &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="variable">elements</span>[<span class="variable">key</span>][<span class="variable">attribute</span>] === <span class="variable">value</span>) {
						<span class="variable">results</span>.<span class="variable">push</span>(<span class="variable">elements</span>[<span class="variable">key</span>]);
					}
				}
				<span class="keyword">return</span> <span class="variable">results</span>;
			}
		};

		<span class="keyword">var</span> <span class="variable">find</span> = {
			<span class="string">'byId'</span>: <span class="keyword">function</span>(<span class="variable">root</span>, <span class="variable">id</span>) {
				<span class="keyword">return</span> (<span class="variable">root</span>) ? [<span class="variable">root</span>.<span class="variable">getElementById</span>(<span class="variable">id</span>)] : [];
			},

			<span class="string">'byNodeName'</span>: <span class="keyword">function</span>(<span class="variable">root</span>, <span class="variable">tagName</span>) {
				<span class="keyword">if</span> (<span class="variable">root</span> === <span class="keyword">null</span>) <span class="keyword">return</span> [];
				<span class="keyword">var</span> <span class="variable">i</span>, <span class="variable">results</span> = [],
				<span class="variable">nodes</span> = <span class="variable">root</span>.<span class="variable">getElementsByTagName</span>(<span class="variable">tagName</span>);

				<span class="keyword">for</span> (<span class="variable">i</span> = <span class="number integer">0</span>; <span class="variable">i</span> &<span class="variable">lt</span>; <span class="variable">nodes</span>.<span class="variable">length</span>; <span class="variable">i</span>++) {
					<span class="variable">results</span>.<span class="variable">push</span>(<span class="variable">nodes</span>[<span class="variable">i</span>]);
				}
				<span class="keyword">return</span> <span class="variable">results</span>;
			},

			<span class="string">'byClassName'</span>: <span class="keyword">function</span>(<span class="variable">root</span>, <span class="variable">className</span>) {
				<span class="keyword">if</span> (<span class="variable">root</span> === <span class="keyword">null</span>) <span class="keyword">return</span> [];
				<span class="keyword">var</span> <span class="variable">i</span>, <span class="variable">results</span> = [],
				<span class="variable">nodes</span> = <span class="variable">root</span>.<span class="variable">getElementsByTagName</span>(<span class="string">'*'</span>);

				<span class="keyword">for</span> (<span class="variable">i</span> = <span class="number integer">0</span>; <span class="variable">i</span> &<span class="variable">lt</span>; <span class="variable">nodes</span>.<span class="variable">length</span>; <span class="variable">i</span>++) {
					<span class="keyword">if</span> (<span class="variable">nodes</span>[<span class="variable">i</span>].<span class="variable">className</span>.<span class="variable">match</span>(<span class="string">'\\b'</span> + <span class="variable">className</span> + <span class="string">'\\b'</span>)) {
						<span class="variable">results</span>.<span class="variable">push</span>(<span class="variable">nodes</span>[<span class="variable">i</span>]);
					}
				}
				<span class="keyword">return</span> <span class="variable">results</span>;
			}
		};

		<span class="keyword">var</span> <span class="variable">findMap</span> = {
			<span class="string">'id'</span>: <span class="keyword">function</span>(<span class="variable">root</span>, <span class="variable">selector</span>) {
				<span class="variable">selector</span> = <span class="variable">selector</span>.<span class="variable">split</span>(<span class="string">'#'</span>)[<span class="number integer">1</span>];
				<span class="keyword">return</span> <span class="variable">find</span>.<span class="variable">byId</span>(<span class="variable">root</span>, <span class="variable">selector</span>);
			},

			<span class="string">'name and id'</span>: <span class="keyword">function</span>(<span class="variable">root</span>, <span class="variable">selector</span>) {
				<span class="keyword">var</span> <span class="variable">matches</span> = <span class="variable">selector</span>.<span class="variable">split</span>(<span class="string">'#'</span>),
				<span class="variable">name</span> = <span class="variable">matches</span>[<span class="number integer">0</span>],
				<span class="variable">id</span> = <span class="variable">matches</span>[<span class="number integer">1</span>];
				<span class="keyword">return</span> <span class="variable">filter</span>.<span class="variable">byAttr</span>(<span class="variable">find</span>.<span class="variable">byId</span>(<span class="variable">root</span>, <span class="variable">id</span>), <span class="string">'nodeName'</span>, <span class="variable">name</span>.<span class="variable">toUpperCase</span>());
			},

			<span class="string">'name'</span>: <span class="keyword">function</span>(<span class="variable">root</span>, <span class="variable">selector</span>) {
				<span class="keyword">return</span> <span class="variable">find</span>.<span class="variable">byNodeName</span>(<span class="variable">root</span>, <span class="variable">selector</span>);
			},

			<span class="string">'class'</span>: <span class="keyword">function</span>(<span class="variable">root</span>, <span class="variable">selector</span>) {
				<span class="variable">selector</span> = <span class="variable">selector</span>.<span class="variable">split</span>(<span class="string">'\.'</span>)[<span class="number integer">1</span>];
				<span class="keyword">return</span> <span class="variable">find</span>.<span class="variable">byClassName</span>(<span class="variable">root</span>, <span class="variable">selector</span>);
			},

			<span class="string">'name and class'</span>: <span class="keyword">function</span>(<span class="variable">root</span>, <span class="variable">selector</span>) {
				<span class="keyword">var</span> <span class="variable">matches</span> = <span class="variable">selector</span>.<span class="variable">split</span>(<span class="string">'\.'</span>),
				<span class="variable">name</span> = <span class="variable">matches</span>[<span class="number integer">0</span>],
				<span class="variable">className</span> = <span class="variable">matches</span>[<span class="number integer">1</span>];
				<span class="keyword">return</span> <span class="variable">filter</span>.<span class="variable">byAttr</span>(<span class="variable">find</span>.<span class="variable">byClassName</span>(<span class="variable">root</span>, <span class="variable">className</span>), <span class="string">'nodeName'</span>, <span class="variable">name</span>.<span class="variable">toUpperCase</span>());
			}
		};

		<span class="keyword">var</span> <span class="variable">matchMap</span> = {
			<span class="string">'id'</span>: <span class="keyword">function</span>(<span class="variable">element</span>, <span class="variable">selector</span>) {
				<span class="variable">selector</span> = <span class="variable">selector</span>.<span class="variable">split</span>(<span class="string">'#'</span>)[<span class="number integer">1</span>];
				<span class="keyword">return</span> <span class="variable">element</span> &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="variable">element</span>.<span class="variable">id</span> === <span class="variable">selector</span>;
			},

			<span class="string">'name'</span>: <span class="keyword">function</span>(<span class="variable">element</span>, <span class="variable">nodeName</span>) {
				<span class="keyword">return</span> <span class="variable">element</span>.<span class="variable">nodeName</span> === <span class="variable">nodeName</span>.<span class="variable">toUpperCase</span>();
			},

			<span class="string">'name and id'</span>: <span class="keyword">function</span>(<span class="variable">element</span>, <span class="variable">selector</span>) {
				<span class="keyword">return</span> <span class="variable">matchMap</span>.<span class="variable">id</span>(<span class="variable">element</span>, <span class="variable">selector</span>) &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="variable">matchMap</span>.<span class="variable">name</span>(<span class="variable">element</span>, <span class="variable">selector</span>.<span class="variable">split</span>(<span class="string">'#'</span>)[<span class="number integer">0</span>]);
			},

			<span class="string">'class'</span>: <span class="keyword">function</span>(<span class="variable">element</span>, <span class="variable">selector</span>) {
				<span class="keyword">if</span> (<span class="variable">element</span> &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="variable">element</span>.<span class="variable">className</span>) {
					<span class="variable">selector</span> = <span class="variable">selector</span>.<span class="variable">split</span>(<span class="string">'\.'</span>)[<span class="number integer">1</span>];
					<span class="keyword">return</span> <span class="variable">element</span>.<span class="variable">className</span>.<span class="variable">match</span>(<span class="string">'\\b'</span> + <span class="variable">selector</span> + <span class="string">'\\b'</span>);
				}
			},

			<span class="string">'name and class'</span>: <span class="keyword">function</span>(<span class="variable">element</span>, <span class="variable">selector</span>) {
				<span class="keyword">return</span> <span class="variable">matchMap</span>[<span class="string">'class'</span>](<span class="variable">element</span>, <span class="variable">selector</span>) &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="variable">matchMap</span>.<span class="variable">name</span>(<span class="variable">element</span>, <span class="variable">selector</span>.<span class="variable">split</span>(<span class="string">'\.'</span>)[<span class="number integer">0</span>]);
			}
		};</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<h2>Each iterator extension</h2>

<p><strong>TODO:</strong></p>

<ul><li>Write docs</li></ul>

<h2></h2>

<ul><li><p><strong>param</strong>: <em>function</em>  cb The callback function to apply</p><pre><code>     </code></pre></li></ul>
</td>
<td class="code">
<pre><code><span class="string">'each'</span>: <span class="keyword">function</span>(<span class="variable">cb</span>) {
				<span class="keyword">var</span> <span class="variable">i</span>;
				<span class="keyword">for</span> (<span class="variable">i</span> = <span class="number integer">0</span>; <span class="variable">i</span> &<span class="variable">lt</span>; <span class="variable">results</span>.<span class="variable">length</span>; <span class="variable">i</span>++) {
					<span class="variable">cb</span>.<span class="variable">apply</span>(<span class="variable">results</span>[<span class="variable">i</span>]);
				}
				<span class="keyword">return</span> <span class="this">this</span>;
			},</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<h2>Event handler extension </h2>

<p><strong>TODO:</strong></p>

<ul><li>Write docs</li></ul>

<h2></h2>

<ul><li><p><strong>param</strong>: <em>event</em>  evt An event listener</p></li><li><p><strong>param</strong>: <em>function</em>  cb The callback function to attach</p><pre><code>     </code></pre></li></ul>
</td>
<td class="code">
<pre><code><span class="string">'on'</span>: <span class="keyword">function</span>(<span class="variable">evt</span>, <span class="variable">cb</span>) {
				<span class="keyword">var</span> <span class="variable">i</span>;
				<span class="keyword">if</span> (<span class="variable">results</span>[<span class="number integer">0</span>].<span class="variable">addEventListener</span>) {
					<span class="keyword">for</span> (<span class="variable">i</span> = <span class="number integer">0</span>; <span class="variable">i</span> &<span class="variable">lt</span>; <span class="variable">results</span>.<span class="variable">length</span>; <span class="variable">i</span>++) {
						<span class="variable">results</span>[<span class="variable">i</span>].<span class="variable">addEventListener</span>(<span class="variable">evt</span>, <span class="variable">cb</span>, <span class="variable">false</span>);
					}
				}
				<span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">results</span>[<span class="number integer">0</span>].<span class="variable">attachEvent</span>) {
					<span class="keyword">for</span> (<span class="variable">i</span> = <span class="number integer">0</span>; <span class="variable">i</span> &<span class="variable">lt</span>; <span class="variable">results</span>.<span class="variable">length</span>; <span class="variable">i</span>++) {
						<span class="variable">results</span>[<span class="variable">i</span>].<span class="variable">attachEvent</span>(<span class="variable">evt</span>, <span class="variable">cb</span>);
					}
				}
				<span class="keyword">return</span> <span class="this">this</span>;
			},</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<h2>CSS handler extension</h2>

<p><strong>TODO:</strong></p>

<ul><li>Write docs</li></ul>

<h2></h2>

<ul><li><p><strong>param</strong>: <em>Object</em>  obj An object containing CSS properties</p><pre><code>     </code></pre></li></ul>
</td>
<td class="code">
<pre><code><span class="string">'css'</span>: <span class="keyword">function</span>(<span class="variable">obj</span>) {
				<span class="keyword">var</span> <span class="variable">i</span>, <span class="variable">key</span>;
				<span class="keyword">for</span> (<span class="variable">i</span> = <span class="number integer">0</span>; <span class="variable">i</span> &<span class="variable">lt</span>; <span class="variable">results</span>.<span class="variable">length</span>; <span class="variable">i</span>++) {
					<span class="keyword">for</span> (<span class="variable">key</span> <span class="keyword">in</span> <span class="variable">obj</span>) {
						<span class="keyword">if</span> (<span class="variable">obj</span>.<span class="variable">hasOwnProperty</span>(<span class="variable">key</span>)) {
							<span class="variable">results</span>[<span class="variable">i</span>].<span class="variable">style</span>.<span class="variable">setProperty</span>(<span class="variable">key</span>, <span class="variable">obj</span>[<span class="variable">key</span>], <span class="string">''</span>); <span class="comment">// The third param is for firefox</span>
						}
					}
				}
				<span class="keyword">return</span> <span class="this">this</span>;
			}
		};

		<span class="comment">// Append methods to the result object</span>
		(<span class="keyword">function</span> <span class="variable">append_methods</span>() {
			<span class="keyword">var</span> <span class="variable">key</span>;
			<span class="keyword">for</span> (<span class="variable">key</span> <span class="keyword">in</span> <span class="variable">methods</span>) {
				<span class="variable">results</span>[<span class="variable">key</span>] = <span class="variable">methods</span>[<span class="variable">key</span>];
			}
		})();
		<span class="keyword">return</span> <span class="variable">results</span>;
	};</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<h1>Framework Ajax Module</h1>

<p><strong>TODO:</strong></p>

<ul><li>Write docs</li><li>Fix Ajax inner method</li></ul>

<h2></h2>

<ul><li><p><strong>param</strong>: <em>Object</em>  setting_input An object containing several AJAX settings</p></li><li><p><strong>api</strong>: <em>public</em></p><p> </p></li></ul>
</td>
<td class="code">
<pre><code><span class="class">Tiramisu</span>.<span class="variable">prototype</span>.<span class="variable">ajax</span> = <span class="variable">window</span>.$<span class="variable">t</span>.<span class="variable">ajax</span> = <span class="keyword">function</span>(<span class="variable">setting_input</span>) {
		<span class="keyword">var</span> <span class="variable">setting_input</span> = <span class="variable">setting_input</span> || {},
            <span class="variable">setting</span> = {
                <span class="variable">method</span>: <span class="string">'GET'</span>,
                <span class="variable">url</span>: <span class="string">''</span>,
                <span class="variable">async</span>: <span class="variable">true</span>,
                <span class="variable">content_type</span>: <span class="string">''</span>,
                <span class="variable">connection</span>: <span class="string">''</span>,
                <span class="variable">parameter</span>: <span class="keyword">null</span>,
                <span class="variable">loader</span>: <span class="string">''</span>,
                <span class="variable">success</span>: <span class="keyword">function</span>() {},
                <span class="variable">successHTML</span>: <span class="string">''</span>,
                <span class="variable">error</span>: <span class="string">''</span>
            },
            <span class="variable">xhr</span> = <span class="keyword">null</span>,
            <span class="variable">parameter</span> = <span class="string">''</span>,
            <span class="variable">parameter_count</span> = <span class="number integer">0</span>;

		<span class="keyword">if</span> (<span class="variable">window</span>.<span class="class">XMLHttpRequest</span>) {
			<span class="variable">xhr</span> = <span class="keyword">new</span> <span class="class">XMLHttpRequest</span>();
		} <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">window</span>.<span class="class">ActiveXObject</span>) {
			<span class="variable">xhr</span> = <span class="keyword">new</span> <span class="class">ActiveXObject</span>(&<span class="variable">quot</span>;<span class="class">Microsoft</span>.<span class="class">XMLHTTP</span>&<span class="variable">quot</span>;);
		} <span class="keyword">else</span> {
			<span class="variable">console</span>.<span class="variable">log</span>(<span class="string">'Object Ajax Error!'</span>);
		}

		<span class="variable">extend</span>(<span class="variable">setting</span>, <span class="variable">setting_input</span>);

		<span class="keyword">if</span> (<span class="variable">tiramisu</span>.<span class="variable">detect</span>(<span class="string">'isIEolder'</span>)) {
			<span class="variable">setting</span>.<span class="variable">method</span> = <span class="string">'POST'</span>;
		}
		<span class="comment">// object &quot;setting.parameter&quot; I create a string with the parameters </span>
		<span class="comment">// to be passed in request</span>
		<span class="keyword">for</span> (<span class="variable">attrname</span> <span class="keyword">in</span> <span class="variable">setting</span>.<span class="variable">parameter</span>) {
			<span class="variable">parameter</span> += <span class="variable">attrname</span> + <span class="string">'='</span> + <span class="variable">setting</span>.<span class="variable">parameter</span>[<span class="variable">attrname</span>] + <span class="string">'&amp;'</span>;
			<span class="variable">parameter_count</span> += <span class="number integer">1</span>;
		}
		<span class="keyword">if</span> (<span class="variable">parameter_count</span>) {
			<span class="keyword">if</span> (!<span class="variable">setting</span>.<span class="variable">content_type</span>) {
				<span class="variable">setting</span>.<span class="variable">content_type</span> = <span class="string">'application/x-www-form-urlencoded'</span>;
			}
			<span class="variable">setting</span>.<span class="variable">method</span> = <span class="string">'POST'</span>;
		}

		<span class="variable">xhr</span>.<span class="variable">open</span>(<span class="variable">setting</span>.<span class="variable">method</span>, <span class="variable">setting</span>.<span class="variable">url</span>, <span class="variable">setting</span>.<span class="variable">async</span>);

		<span class="keyword">if</span> (<span class="variable">setting</span>.<span class="variable">content_type</span>) {
			<span class="variable">xhr</span>.<span class="variable">setRequestHeader</span>(<span class="string">'Content-type'</span>, <span class="variable">setting</span>.<span class="variable">content_type</span>);
		}

		<span class="keyword">if</span> (<span class="variable">setting</span>.<span class="variable">connection</span>) {
			<span class="variable">xhr</span>.<span class="variable">setRequestHeader</span>(<span class="string">'Connection'</span>, <span class="variable">setting</span>.<span class="variable">connection</span>);
		}

		<span class="variable">xhr</span>.<span class="variable">onreadystatechange</span> = <span class="keyword">function</span>() {
			<span class="keyword">if</span> (<span class="variable">xhr</span>.<span class="variable">readyState</span> == <span class="number integer">4</span> &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="variable">xhr</span>.<span class="variable">status</span> == <span class="number integer">200</span>) {
				<span class="keyword">if</span> (<span class="variable">setting</span>.<span class="variable">successHTML</span>) {
					<span class="variable">tiramisu</span>.<span class="variable">d</span>.<span class="variable">getElementById</span>(<span class="variable">setting</span>.<span class="variable">successHTML</span>).<span class="variable">innerHTML</span> = <span class="variable">xhr</span>.<span class="variable">responseText</span>;
				} <span class="keyword">else</span> {
					<span class="variable">setting</span>.<span class="variable">success</span>(<span class="variable">xhr</span>.<span class="variable">responseText</span>);
				}
			}
		};

		<span class="variable">xhr</span>.<span class="variable">send</span>(<span class="variable">parameter</span>);
		<span class="keyword">return</span> <span class="this">this</span>;
	};</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<h1>Task Engine Module</h1>

<p><strong>TODO:</strong></p>

<ul><li>Write docs</li></ul>

<h2></h2>

<ul><li><p><strong>param</strong>: <em>integer</em>  delay The total task delay(ms)</p></li><li><p><strong>param</strong>: <em>integer</em>  [interval] The interval of the repetitions(ms)</p></li><li><p><strong>param</strong>: <em>Function</em>  cb The callback function</p><p> </p></li></ul>
</td>
<td class="code">
<pre><code><span class="class">Tiramisu</span>.<span class="variable">prototype</span>[<span class="string">'do'</span>] = <span class="keyword">function</span>(<span class="variable">delay</span>, <span class="variable">cb</span>) {
		<span class="comment">// tiramisu.do(delay, [interval], callback) where “interval”</span>
		<span class="comment">// is an optional argument</span>
		<span class="keyword">var</span> <span class="variable">interval</span>;

		<span class="comment">// Saving reference for nested function calling</span>
		<span class="keyword">var</span> <span class="variable">requestAnimFrame</span> = <span class="variable">requestAnimFrame</span> || <span class="this">this</span>.<span class="variable">requestAnimFrame</span>;

		<span class="keyword">if</span> (<span class="variable">arguments</span>.<span class="variable">length</span> &<span class="variable">gt</span>; <span class="number integer">2</span>) {
			<span class="variable">interval</span> = <span class="variable">arguments</span>[<span class="number integer">1</span>];
			<span class="variable">cb</span> = <span class="variable">arguments</span>[<span class="variable">arguments</span>.<span class="variable">length</span> - <span class="number integer">1</span>];
		}

		<span class="keyword">var</span> <span class="variable">start</span> = + <span class="keyword">new</span> <span class="class">Date</span>(),
		<span class="variable">pass</span> = <span class="variable">interval</span>;

		<span class="keyword">function</span> <span class="variable">animate</span>() {
			<span class="keyword">var</span> <span class="variable">progress</span> = + <span class="keyword">new</span> <span class="class">Date</span>() - <span class="variable">start</span>;

			<span class="keyword">if</span> (<span class="variable">interval</span> !== <span class="variable">undefined</span>) {
				<span class="keyword">if</span> (<span class="variable">progress</span> &<span class="variable">gt</span>; <span class="variable">pass</span>) {
					<span class="variable">pass</span> += <span class="variable">interval</span>;
					<span class="variable">cb</span>();
				}
			}

			<span class="keyword">if</span> (<span class="variable">progress</span> &<span class="variable">lt</span>; <span class="variable">delay</span>) {
				<span class="variable">requestAnimFrame</span>(<span class="variable">animate</span>);
			} <span class="keyword">else</span> {
				<span class="keyword">if</span> (<span class="variable">interval</span> === <span class="variable">undefined</span>) {
					<span class="variable">cb</span>();
				}
			}
		}
		<span class="variable">animate</span>();
	};
})(<span class="variable">window</span>);
</code></pre>
</td>
</tr>	</body>
</html></tbody></table>